<!DOCTYPE html>


<html lang="zh-Hans">
  

    <head>
      <meta charset="utf-8" />
        
      <meta
        name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1"
      />
      <title> Anthony</title>
  <meta name="generator" content="hexo-theme-ayer">
      
      <link rel="shortcut icon" href="/favicon.ico" />
       
<link rel="stylesheet" href="/dist/main.css">

      
<link rel="stylesheet" href="/css/fonts/remixicon.css">

      
<link rel="stylesheet" href="/css/custom.css">
 
      <script src="https://cdn.staticfile.org/pace/1.2.4/pace.min.js"></script>
       
 

      <link
        rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/@sweetalert2/theme-bulma@5.0.1/bulma.min.css"
      />
      <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.19/dist/sweetalert2.min.js"></script>

      <!-- mermaid -->
      
      <style>
        .swal2-styled.swal2-confirm {
          font-size: 1.6rem;
        }
      </style>
    <link rel="alternate" href="/atom.xml" title="Anthony" type="application/atom+xml">
</head>
  </html>
</html>




<body>
  <div id="app">
    
      
    <main class="content on">
      
<section class="cover">
    
      
      <a class="forkMe" href="https://github.com/Anthony-36"
        target="_blank"><img width="149" height="149" src="/images/forkme.png"
          class="attachment-full size-full" alt="Fork me on GitHub" data-recalc-dims="1"></a>
    
  <div class="cover-frame">
    <div class="bg-box">
      <img src="/images/cover1.jpg" alt="image frame" />
    </div>
    <div class="cover-inner text-center text-white">
      <h1><a href="/">Anthony</a></h1>
      <div id="subtitle-box">
        
        <span id="subtitle"></span>
        
      </div>
      <div>
        
      </div>
    </div>
  </div>
  <div class="cover-learn-more">
    <a href="javascript:void(0)" class="anchor"><i class="ri-arrow-down-line"></i></a>
  </div>
</section>



<script src="https://cdn.staticfile.org/typed.js/2.0.12/typed.min.js"></script>


<!-- Subtitle -->

  <script>
    try {
      var typed = new Typed("#subtitle", {
        strings: ['愿你一生努力，一生被爱', '想要的都拥有，得不到的都释怀', '怕什么真理无穷，进一寸有进一寸的欢喜'],
        startDelay: 0,
        typeSpeed: 200,
        loop: true,
        backSpeed: 100,
        showCursor: true
      });
    } catch (err) {
      console.log(err)
    }
  </script>
  
<div id="main">
  <section class="outer">
  
  
  

<div class="notice" style="margin-top:50px">
    <i class="ri-heart-fill"></i>
    <div class="notice-content" id="broad"></div>
</div>
<script type="text/javascript">
    fetch('https://v1.hitokoto.cn')
        .then(response => response.json())
        .then(data => {
            document.getElementById("broad").innerHTML = data.hitokoto;
        })
        .catch(console.error)
</script>

<style>
    .notice {
        padding: 20px;
        border: 1px dashed #e6e6e6;
        color: #969696;
        position: relative;
        display: inline-block;
        width: 100%;
        background: #fbfbfb50;
        border-radius: 10px;
    }

    .notice i {
        float: left;
        color: #999;
        font-size: 16px;
        padding-right: 10px;
        vertical-align: middle;
        margin-top: -2px;
    }

    .notice-content {
        display: initial;
        vertical-align: middle;
    }
</style>
  
  <article class="articles">
    
    
    
    
    <article
  id="post-MoveIt的使用（三）机械臂在rviz中的可视化以及编程控制"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/03/20/MoveIt%E7%9A%84%E4%BD%BF%E7%94%A8%EF%BC%88%E4%B8%89%EF%BC%89%E6%9C%BA%E6%A2%B0%E8%87%82%E5%9C%A8rviz%E4%B8%AD%E7%9A%84%E5%8F%AF%E8%A7%86%E5%8C%96%E4%BB%A5%E5%8F%8A%E7%BC%96%E7%A8%8B%E6%8E%A7%E5%88%B6/"
    >MoveIt的使用（三）机械臂在rviz中的可视化以及编程控制</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/03/20/MoveIt%E7%9A%84%E4%BD%BF%E7%94%A8%EF%BC%88%E4%B8%89%EF%BC%89%E6%9C%BA%E6%A2%B0%E8%87%82%E5%9C%A8rviz%E4%B8%AD%E7%9A%84%E5%8F%AF%E8%A7%86%E5%8C%96%E4%BB%A5%E5%8F%8A%E7%BC%96%E7%A8%8B%E6%8E%A7%E5%88%B6/" class="article-date">
  <time datetime="2022-03-20T05:12:35.000Z" itemprop="datePublished">2022-03-20</time>
</a>    
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <p>在第一篇文章中，我们实现了从solidworks到urdf文件的转换，第二篇文章，主要介绍了MoveIt！Setup Assistant的配置，以及机械臂的初步可视化，下面我们继续实现机械臂在rviz中的可视化以及编程控制。</p>
<h1 id="一、机械臂的rviz可视化"><a href="#一、机械臂的rviz可视化" class="headerlink" title="一、机械臂的rviz可视化"></a>一、机械臂的rviz可视化</h1><p>打开配置好moveit的机械臂文件</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">source devel/setup.bash</span><br><span class="line">roslaunch marm_moveit_config demo.launch</span><br></pre></td></tr></table></figure>
<p>可以鼠标移动机械臂末端的小球，机械臂的各个关节也会进行转动使机械臂的末端始终在小球处。</p>
<h3 id="1-可视化"><a href="#1-可视化" class="headerlink" title="1.可视化"></a>1.可视化</h3><p><img src="https://img-blog.csdnimg.cn/d21f995e4e664235b61437c182240cce.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAYW50aG9ueS0zNg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<h3 id="2-各关节角度控制"><a href="#2-各关节角度控制" class="headerlink" title="2.各关节角度控制"></a>2.各关节角度控制</h3><p><img src="https://img-blog.csdnimg.cn/f1ca01bfdfec41bb88e091cb37ac5674.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAYW50aG9ueS0zNg==,size_14,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<h3 id="3-选择随机位置，进行规划"><a href="#3-选择随机位置，进行规划" class="headerlink" title="3.选择随机位置，进行规划"></a>3.选择随机位置，进行规划</h3><p><img src="https://img-blog.csdnimg.cn/da57b6ab23144e5c8378b09cfb59e2a4.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAYW50aG9ueS0zNg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<h1 id="二、初步编程控制"><a href="#二、初步编程控制" class="headerlink" title="二、初步编程控制"></a>二、初步编程控制</h1><p>在生成的配置文件和三维模型代码所在的工作空间，创建功能包。<br>建立moveit_fk_demo.py文件，内容如下，本次使用的机械臂没有设置末端执行器，所以代码中关于末端执行器的代码已经注释掉，如有需要再解除注释。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> rospy, sys</span><br><span class="line"><span class="keyword">import</span> moveit_commander</span><br><span class="line"><span class="keyword">from</span> control_msgs.msg <span class="keyword">import</span> GripperCommand</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MoveItFkDemo</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="comment"># 初始化move_group的API</span></span><br><span class="line">        moveit_commander.roscpp_initialize(sys.argv)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 初始化ROS节点</span></span><br><span class="line">        rospy.init_node(<span class="string">&#x27;moveit_fk_demo&#x27;</span>, anonymous=<span class="literal">True</span>)</span><br><span class="line"> </span><br><span class="line">        <span class="comment"># 初始化需要使用move group控制的机械臂中的arm group</span></span><br><span class="line">        arm = moveit_commander.MoveGroupCommander(<span class="string">&#x27;arm&#x27;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 初始化需要使用move group控制的机械臂中的gripper group</span></span><br><span class="line">        <span class="comment">#gripper = moveit_commander.MoveGroupCommander(&#x27;gripper&#x27;)</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 设置机械臂和夹爪的允许误差值</span></span><br><span class="line">        arm.set_goal_joint_tolerance(<span class="number">0.001</span>)</span><br><span class="line">        <span class="comment">#gripper.set_goal_joint_tolerance(0.001)</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 控制机械臂先回到初始化位置</span></span><br><span class="line">        arm.set_named_target(<span class="string">&#x27;home&#x27;</span>)</span><br><span class="line">        arm.go()</span><br><span class="line">        rospy.sleep(<span class="number">2</span>)</span><br><span class="line">         </span><br><span class="line">        <span class="comment"># 设置夹爪的目标位置，并控制夹爪运动</span></span><br><span class="line">        <span class="comment">#gripper.set_joint_value_target([0.01])</span></span><br><span class="line">        <span class="comment">#gripper.go()</span></span><br><span class="line">        <span class="comment">#rospy.sleep(1)</span></span><br><span class="line">         </span><br><span class="line">        <span class="comment"># 设置机械臂的目标位置，使用六轴的位置数据进行描述（单位：弧度）</span></span><br><span class="line">        joint_positions = [-<span class="number">1.4311</span>, <span class="number">0.4188</span>, <span class="number">0.5759</span>, -<span class="number">0.4886</span>, <span class="number">0.4712</span>]</span><br><span class="line">        arm.set_joint_value_target(joint_positions)</span><br><span class="line">                 </span><br><span class="line">        <span class="comment"># 控制机械臂完成运动</span></span><br><span class="line">        arm.go()</span><br><span class="line">        rospy.sleep(<span class="number">1</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 关闭并退出moveit</span></span><br><span class="line">        moveit_commander.roscpp_shutdown()</span><br><span class="line">        moveit_commander.os._exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        MoveItFkDemo()</span><br><span class="line">    <span class="keyword">except</span> rospy.ROSInterruptException:</span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>
<p>编译好后，启动rviz，然后运行上述功能包。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">roslaunch marm_moveit_config demo.launch</span><br><span class="line">rosrun marm_planning moveit_fk_demo.py</span><br></pre></td></tr></table></figure>
<p>上述代码，先让机械臂回到预先定义的home状态，然后再自动规划到下面代码设置到位置。</p>
<blockquote>
<p>joint_positions &#x3D; [-1.4311, 0.4188, 0.5759, -0.4886, 0.4712]</p>
</blockquote>
<p>代码中这一行是，从关节joint1到joint5，各个关节的弧度，可以调节这几个数字，让机械臂呈现不同的姿态。</p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ROS%E3%80%81C-%E3%80%81%E6%9C%BA%E6%A2%B0%E8%87%82/" rel="tag">ROS、C++、机械臂</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-MoveIt的使用（二）机械臂URDF在ROS中MoveIt的配置和使用"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/03/20/MoveIt%E7%9A%84%E4%BD%BF%E7%94%A8%EF%BC%88%E4%BA%8C%EF%BC%89%E6%9C%BA%E6%A2%B0%E8%87%82URDF%E5%9C%A8ROS%E4%B8%ADMoveIt%E7%9A%84%E9%85%8D%E7%BD%AE%E5%92%8C%E4%BD%BF%E7%94%A8/"
    >MoveIt的使用（二）机械臂URDF在ROS中MoveIt的配置和使用</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/03/20/MoveIt%E7%9A%84%E4%BD%BF%E7%94%A8%EF%BC%88%E4%BA%8C%EF%BC%89%E6%9C%BA%E6%A2%B0%E8%87%82URDF%E5%9C%A8ROS%E4%B8%ADMoveIt%E7%9A%84%E9%85%8D%E7%BD%AE%E5%92%8C%E4%BD%BF%E7%94%A8/" class="article-date">
  <time datetime="2022-03-20T05:12:35.000Z" itemprop="datePublished">2022-03-20</time>
</a>    
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="一、机械臂在ros里面的可视化"><a href="#一、机械臂在ros里面的可视化" class="headerlink" title="一、机械臂在ros里面的可视化"></a>一、机械臂在ros里面的可视化</h1><p>在SOLIDWORKS转换成urdf文件之后，生成的文件放在新建的功能包中后，编译（catkin_make），再执行下面代码即可运行可视化文件</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">roslaunch description dispaly.launch</span><br></pre></td></tr></table></figure>

<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">roslaunch description gazebo.launch</span><br></pre></td></tr></table></figure>
<p>这两个文件是转换成urdf文件里面自动生成的，description是自己命名的solidworks生成的文件，第一个是rviz可视化机械臂，第二个是gazebo仿真环境可视化机械臂。<br><img src="https://img-blog.csdnimg.cn/f4d671fb94de440091ba603c7a55f764.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAYW50aG9ueS0zNg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>运行之后需要把坐标系更改为base_link，在Add里面添加RobotModel，这样就可以显示机械臂了。</p>
<h1 id="二、配置MoveIt！Setup-Assistant"><a href="#二、配置MoveIt！Setup-Assistant" class="headerlink" title="二、配置MoveIt！Setup Assistant"></a>二、配置MoveIt！Setup Assistant</h1><p>安装MoveIt</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt<span class="literal">-get</span> install ros<span class="literal">-noetic-moveit</span></span><br><span class="line">source /opt/ros/noetic/setup.bash</span><br></pre></td></tr></table></figure>
<p>这里可以用下面的代码查看是否安装成功，并查看moveit!的版本</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moveit_version</span><br></pre></td></tr></table></figure>
<p>然后启动MoveIt！Setup Assistant，这一步需要在新建的工作空间中执行，并且打开rocore ，再source一下，因为下面会需要选择功能包中的urdf文件，不在功能包中会失败。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">roscore</span><br><span class="line">source devel/setup.bash</span><br><span class="line">rosrun moveit_setup_assistant moveit_setup_assistant</span><br></pre></td></tr></table></figure>
<h3 id="1-开始配置"><a href="#1-开始配置" class="headerlink" title="1.开始配置"></a>1.开始配置</h3><p>在运行上一行代码后，会启动带有两个选择的开始屏幕：创建新的MoveIt配置包（Create New MoveIt Configuration Package）或编辑现有的MoveIt配置包（Edit Existing MoveIt Configuration Package）。</p>
<ul>
<li><p>点击“创建新的moveit配置包”按钮。<br><img src="https://img-blog.csdnimg.cn/06b58664cf3c4179b75561476e9c4f90.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAYW50aG9ueS0zNg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
</li>
<li><p>后面的界面，选择功能包中的urdf文件，然后点击Load Files<br><img src="https://img-blog.csdnimg.cn/5cb9ab81bd764bf2be478e54986f17f8.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAYW50aG9ueS0zNg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
</li>
</ul>
<blockquote>
<p>如果遇到</p>
<figure class="highlight powershell"><figcaption><span>ROS was unable to find the package name</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;xarm_description&#x27;</span>. Verify this package is inside your ROS workspace</span><br><span class="line">and is a proper ROS package.</span><br><span class="line"></span><br><span class="line"><span class="number">1</span>.首先需要确认，roscore是否已经运行。</span><br><span class="line"></span><br><span class="line"><span class="number">2</span>.在Workspace的devel文件夹下，打开命令行，并且输入source setup.bash，将文件目录加载到命令行中。</span><br><span class="line"></span><br><span class="line"><span class="number">3</span>.再次输入 rosrun moveit_setup_assistant moveit_setup_assistant 打开moveit！Setup assistant工具</span><br><span class="line"></span><br><span class="line"><span class="comment">### 2.产生自碰撞矩阵 Self-Collision Matrix</span></span><br><span class="line">默认自碰撞矩阵生成器在机器人上搜索可以安全禁用碰撞检查的链接对，从而减少了运动计划的处理时间。当这些链接对始终处于碰撞状态，从不碰撞，处于机器人默认位置的碰撞状态或在运动链上彼此相邻时，这些链接对将被禁用。采样密度指定要检查自我碰撞的随机机器人位置的数量。较高的密度需要更多的计算时间，而较低的密度则有可能禁用不应禁用的对。默认值为<span class="number">10</span>,<span class="number">000</span>个冲突检查。并行执行冲突检查以减少处理时间。</span><br><span class="line">![在这里插入图片描述](https://img<span class="literal">-blog</span>.csdnimg.cn/<span class="number">396168</span>ebc7ab4d9987b5ba40dfe2eed1.png?x<span class="literal">-oss-process</span>=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAYW50aG9ueS0zNg==,size_20,color_FFFFFF,t_70,g_se,x_16)</span><br><span class="line">* 单击左侧的“ 自碰撞”窗格选择器，然后单击“ 生成碰撞矩阵”按钮。在将您的计算结果显示在主表中之前，设置助手将工作几秒钟。</span><br><span class="line">![在这里插入图片描述](https://img<span class="literal">-blog</span>.csdnimg.cn/<span class="number">9</span>acca58b869c4f53ac41f92961f56013.png?x<span class="literal">-oss-process</span>=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAYW50aG9ueS0zNg==,size_20,color_FFFFFF,t_70,g_se,x_16)</span><br><span class="line"><span class="comment">### 3.添加虚拟关节 virtual joint</span></span><br><span class="line">这一步骤主要是将机械臂连接到其他部件上，这次咱们只用了机械臂，就不进行设置。</span><br><span class="line"></span><br><span class="line"><span class="comment">### 4.添加规划组 planning group</span></span><br><span class="line">moveit通过定义规划组（planning <span class="built_in">group</span>）来语义上定义机械臂的各个部分（如手臂和末端执行器），这一部分很重要。</span><br><span class="line">* 点击左侧Planning Groups</span><br><span class="line">* 点击Add <span class="built_in">Group</span></span><br><span class="line">![在这里插入图片描述](https://img<span class="literal">-blog</span>.csdnimg.cn/bd1452cfecd149919f8e7ddf3eff61f5.png?x<span class="literal">-oss-process</span>=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAYW50aG9ueS0zNg==,size_20,color_FFFFFF,t_70,g_se,x_16)</span><br><span class="line">添加手臂规划组arm</span><br><span class="line">* 输入名称 arm</span><br><span class="line">* 运动学求解器选择kdl_kinematics_plugin/KDLKinematicsPlugin </span><br><span class="line">* Kin.parameters file选择solidworks插件生成的config文件夹里面的文件</span><br><span class="line"></span><br><span class="line">* 点击Add Joint ，会出现所有关节，选择属于机械臂的关节，再点击&gt;添加到右侧。</span><br><span class="line">这个地方要注意是属于机械臂的关节，还是末端执行器的关节。</span><br><span class="line">* 点击保存</span><br><span class="line">![在这里插入图片描述](https://img<span class="literal">-blog</span>.csdnimg.cn/<span class="number">23</span>bac2ec24ce4df18317c9175f13ad11.png?x<span class="literal">-oss-process</span>=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAYW50aG9ueS0zNg==,size_20,color_FFFFFF,t_70,g_se,x_16)</span><br><span class="line">添加末端执行器规划组，步骤跟第一步一样，在选择关节的时候注意选择末端执行器的关节。</span><br><span class="line"><span class="comment">### 5.添加机器人姿态 Robot Poses</span></span><br><span class="line">moveit允许添加预设的机器人姿态，方便之后使用，例如在后面进行运动规划的时候，一条语句就可以让机械臂运动到，预设的姿态。</span><br><span class="line">* 选择左侧 Robot Poses</span><br><span class="line">* 点击规划组arm，右侧会出现各个关节的滑条，拖动设置想要的姿态</span><br><span class="line">* 点击Save保存</span><br><span class="line">![在这里插入图片描述](https://img<span class="literal">-blog</span>.csdnimg.cn/<span class="number">2469</span>efe96db04e7987b7a0cb04bc37cc.png?x<span class="literal">-oss-process</span>=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAYW50aG9ueS0zNg==,size_20,color_FFFFFF,t_70,g_se,x_16)</span><br><span class="line">![在这里插入图片描述](https://img<span class="literal">-blog</span>.csdnimg.cn/<span class="number">22648</span>acc28f946b28c7ef43020e6d433.png?x<span class="literal">-oss-process</span>=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAYW50aG9ueS0zNg==,size_20,color_FFFFFF,t_70,g_se,x_16)</span><br><span class="line"></span><br><span class="line"><span class="comment">### 6.配置末端执行器End Effectors</span></span><br><span class="line">MoveIt中会给末端执行器一个专门的标签<span class="literal">-End</span> Effectors。之前我们已经为末端执行器添加了规划组，这里我们要将其标记为<span class="keyword">End</span> Effector</span><br><span class="line"></span><br><span class="line">* 选择左侧<span class="keyword">End</span> Effectors</span><br><span class="line">* 点击Add <span class="keyword">End</span> Effector</span><br><span class="line">* <span class="keyword">End</span> Effector Name设置为hand</span><br><span class="line">* <span class="keyword">End</span> Effector <span class="built_in">Group</span>选择之前添加的末端执行器规划组</span><br><span class="line">* 父关节选择为机械臂与末端执行器连接的关节</span><br><span class="line">* 父规划组选择留空白</span><br><span class="line">![在这里插入图片描述](https://img<span class="literal">-blog</span>.csdnimg.cn/<span class="number">6041</span>b8c8ea4649edab748456075353d1.png?x<span class="literal">-oss-process</span>=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAYW50aG9ueS0zNg==,size_20,color_FFFFFF,t_70,g_se,x_16)</span><br><span class="line"><span class="comment">### 7.添加被动关节Passive Joints</span></span><br><span class="line">如果机器人中有被动的关节（不是主动控制的关节），需要将其添加为被动关节，这样可以告诉MoveIt在规划运动的时候这些关节是无法主动控制的。</span><br><span class="line">我们机械臂中没有被动关节，跳过这一步。</span><br><span class="line">![在这里插入图片描述](https://img<span class="literal">-blog</span>.csdnimg.cn/<span class="number">0</span>b4ce33f4d3d498481885d3d85cd10b5.png?x<span class="literal">-oss-process</span>=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAYW50aG9ueS0zNg==,size_20,color_FFFFFF,t_70,g_se,x_16)</span><br><span class="line"></span><br><span class="line"><span class="comment">### 8.设置3D感知 3D Perception</span></span><br><span class="line">这里可以为机械臂添加传感器，如kinetic。</span><br><span class="line">参数配置参考tutorial</span><br><span class="line"></span><br><span class="line">如没有传感器，设置为None</span><br><span class="line">![在这里插入图片描述](https://img<span class="literal">-blog</span>.csdnimg.cn/<span class="number">79396</span>f4c20f34d59a4eb19896d674ee0.png?x<span class="literal">-oss-process</span>=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAYW50aG9ueS0zNg==,size_20,color_FFFFFF,t_70,g_se,x_16)</span><br><span class="line"></span><br><span class="line"><span class="comment">### 9.Gazebo仿真</span></span><br><span class="line">如果需要在Gazebo中仿真，可以在这里生成需要的URDF文件。（不需要可以跳过）</span><br><span class="line"></span><br><span class="line">生成URDF后，通过如下步骤在Gazebo中生成仿真</span><br><span class="line">* 建立一个空的world</span><br><span class="line"></span><br><span class="line">```powershell</span><br><span class="line">roslaunch gazebo_ros empty_world.launch paused:=true use_sim_time:=false gui:=true throttled:=false recording:=false debug:=true</span><br></pre></td></tr></table></figure>
</blockquote>
<ul>
<li>加载模型</li>
</ul>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rosrun gazebo_ros spawn_model <span class="operator">-file</span> &lt;/path_to_new_urdf/file_name.urdf&gt; <span class="literal">-urdf</span> <span class="literal">-x</span> <span class="number">0</span> <span class="literal">-y</span> <span class="number">0</span> <span class="literal">-z</span> <span class="number">1</span> <span class="literal">-model</span> panda</span><br></pre></td></tr></table></figure>


<h3 id="10-添加作者信息"><a href="#10-添加作者信息" class="headerlink" title="10.添加作者信息"></a>10.添加作者信息</h3><p>可以把自己的信息填入，之后发布的时候需要</p>
<ul>
<li>选择Author Information</li>
<li>输入名字和邮箱<br><img src="https://img-blog.csdnimg.cn/9847b4c1328042f8927ef733202b7a2f.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAYW50aG9ueS0zNg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></li>
</ul>
<h3 id="11-生成配置文件"><a href="#11-生成配置文件" class="headerlink" title="11.生成配置文件"></a>11.生成配置文件</h3><ul>
<li>选择左侧Configuration Files，点击Browse选择一个合适的位置，<br><img src="https://img-blog.csdnimg.cn/307646dd7b56479b94c519d347d49193.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAYW50aG9ueS0zNg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></li>
</ul>
<h1 id="三、启动rivz可视化"><a href="#三、启动rivz可视化" class="headerlink" title="三、启动rivz可视化"></a>三、启动rivz可视化</h1><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">roslaunch marm_moveit_config demo.launch</span><br></pre></td></tr></table></figure>
<p>关于这个时候的rviz以及moveit编程控制，下一个文章会详细讲解一下。</p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ROS%E3%80%81C-%E3%80%81%E6%9C%BA%E6%A2%B0%E8%87%82/" rel="tag">ROS、C++、机械臂</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-使用jeston-nano-ros-melodic-RPLIDAR构建地图"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/03/15/%E4%BD%BF%E7%94%A8jeston-nano-ros-melodic-RPLIDAR%E6%9E%84%E5%BB%BA%E5%9C%B0%E5%9B%BE/"
    >使用jeston nano+ros melodic+RPLIDAR构建地图</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/03/15/%E4%BD%BF%E7%94%A8jeston-nano-ros-melodic-RPLIDAR%E6%9E%84%E5%BB%BA%E5%9C%B0%E5%9B%BE/" class="article-date">
  <time datetime="2022-03-15T09:57:47.000Z" itemprop="datePublished">2022-03-15</time>
</a>    
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <p>​        RPLIDAR是低成本的二维雷达解决方案，由SLAMTec公司的RoboPeak团队开发，本次学习使用的是PRLIDAR A2型号的激光雷达，其具有16米测量半径，8000次&#x2F;秒的测量频率，非常谁和用于构建地图、做SLAM或构建3D模型。</p>
<p><img src="/%7F(jeston-nano-ros-melodic-RPLIDAR%EF%BF%BD%EF%BF%BD0%EF%BF%BD%5CY@PSF(D2PW30JZPG~%5D2$%5B%25F.png" alt=" "></p>
<p><img src="http://images.ncnynl.com/ros/2016/rplidar_A2.png" alt="请输入图片描述"></p>
<h3 id="1、创建工作空间"><a href="#1、创建工作空间" class="headerlink" title="1、创建工作空间"></a>1、创建工作空间</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p ~/turtlebot_ws/src</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd ~/turtlebot_ws/src</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/ncnynl/rplidar_ros.git</span><br></pre></td></tr></table></figure>

<p>这一步克隆如果不成功可以多试几次，或者到github上找到包，自己克隆一下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd ..</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">catkin_make</span><br></pre></td></tr></table></figure>

<h3 id="2、设置环境变量"><a href="#2、设置环境变量" class="headerlink" title="2、设置环境变量"></a>2、设置环境变量</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">`source /turtlebot_ws/devel/setup.bash`</span><br></pre></td></tr></table></figure>

<p>玩过ros的应该都知道这一步</p>
<p>下面配置端口</p>
<ul>
<li>检查端口权限</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ls -l /dev |grep ttyUSB</span><br></pre></td></tr></table></figure>

<ul>
<li>赋予端口权限666</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo chmod 666 /dev/ttyUSB0</span><br></pre></td></tr></table></figure>

<h3 id="3-运行测试"><a href="#3-运行测试" class="headerlink" title="3.运行测试"></a>3.运行测试</h3><p>运行PRLIDAR和并打开rviz查看：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">roslaunch rplidar_ros view_rplidar.launch</span><br></pre></td></tr></table></figure>

<p>运行PRLIDAR和查看测试应用</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">roslaunch rplidar_ros rplidar.launch</span><br></pre></td></tr></table></figure>

<p>新终端打开：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rosrun rplidar_ros rplidarNodeClient</span><br></pre></td></tr></table></figure>

<h4 id="4、构建地图"><a href="#4、构建地图" class="headerlink" title="4、构建地图"></a>4、构建地图</h4><p>①hector_mapping包安装：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install ros-melodic-hector-slam</span><br></pre></td></tr></table></figure>

<p>②创建launch文件：</p>
<p>在rplidar_ros&#x2F;launch&#x2F;目录下添加hector_mapping_demo.launch文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&lt;launch&gt;</span><br><span class="line">​	&lt;node pkg=&quot;hector_mapping&quot; type=&quot;hector_mapping&quot; name=&quot;hector_mapping&quot; output=&quot;screen&quot;&gt;</span><br><span class="line">​		&lt;param name=&quot;pub_map_odom_transform&quot; value=&quot;true&quot;/&gt;</span><br><span class="line">​		&lt;param name=&quot;map_frame&quot; value=&quot;map&quot; /&gt;</span><br><span class="line">​		&lt;param name=&quot;base_frame&quot; value=&quot;base_link&quot; /&gt;</span><br><span class="line">​		&lt;param name=&quot;odom_frame&quot; value=&quot;base_link&quot; /&gt;</span><br><span class="line">​		&lt;param name=&quot;use_tf_scan_transformation&quot; value=&quot;true&quot;/&gt;</span><br><span class="line">​		&lt;param name=&quot;use_tf_pose_start_estimate&quot; value=&quot;false&quot;/&gt;</span><br><span class="line">​		&lt;param name=&quot;map_resolution&quot; value=&quot;0.05&quot;/&gt;</span><br><span class="line">​		&lt;param name=&quot;map_size&quot; value=&quot;2048&quot;/&gt;</span><br><span class="line">​		&lt;param name=&quot;map_start_x&quot; value=&quot;0.5&quot;/&gt;</span><br><span class="line">​		&lt;param name=&quot;map_start_y&quot; value=&quot;0.5&quot; /&gt;</span><br><span class="line">​		&lt;param name=&quot;laser_z_min_value&quot; value = &quot;-1.0&quot; /&gt;</span><br><span class="line">​		&lt;param name=&quot;laser_z_max_value&quot; value = &quot;1.0&quot; /&gt;</span><br><span class="line">​		&lt;param name=&quot;map_multi_res_levels&quot; value=&quot;2&quot; /&gt;</span><br><span class="line">​		&lt;param name=&quot;map_pub_period&quot; value=&quot;2&quot; /&gt;</span><br><span class="line">​		&lt;param name=&quot;laser_min_dist&quot; value=&quot;0.4&quot; /&gt;</span><br><span class="line">​		&lt;param name=&quot;laser_max_dist&quot; value=&quot;5.5&quot; /&gt;</span><br><span class="line">​		&lt;param name=&quot;output_timing&quot; value=&quot;false&quot; /&gt;</span><br><span class="line">​		&lt;param name=&quot;pub_map_scanmatch_transform&quot; value=&quot;true&quot; /&gt;</span><br><span class="line">​		&lt;param name=&quot;update_factor_free&quot; value=&quot;0.4&quot;/&gt;</span><br><span class="line">​		&lt;param name=&quot;update_factor_occupied&quot; value=&quot;0.7&quot; /&gt;    </span><br><span class="line">​		&lt;param name=&quot;map_update_distance_thresh&quot; value=&quot;0.2&quot;/&gt;</span><br><span class="line">​		&lt;param name=&quot;map_update_angle_thresh&quot; value=&quot;0.06&quot; /&gt;</span><br><span class="line">​		&lt;param name=&quot;advertise_map_service&quot; value=&quot;true&quot;/&gt;</span><br><span class="line">​		&lt;param name=&quot;scan_subscriber_queue_size&quot; value=&quot;5&quot;/&gt;</span><br><span class="line">​		&lt;param name=&quot;scan_topic&quot; value=&quot;scan&quot;/&gt;</span><br><span class="line">​	&lt;/node&gt;</span><br><span class="line">​	&lt;node pkg=&quot;tf&quot; type=&quot;static_transform_publisher&quot; name=&quot;base_to_laser_broadcaster&quot; args=&quot;0 0 0 0 0 0 /base_link /laser 100&quot;/&gt;</span><br><span class="line">​	&lt;node pkg=&quot;rviz&quot; type=&quot;rviz&quot; name=&quot;rviz&quot; args=&quot;-d $(find hector_slam_launch)/rviz_cfg/mapping_demo.rviz&quot;/&gt;</span><br><span class="line">&lt;/launch&gt;`</span><br></pre></td></tr></table></figure>

<p>如果有错误，请先查看格式缩进是否对应，语言的结束符号&#x2F;是否加注合格。</p>
<p>③运行测试</p>
<p>运行前查看端口号、给予端口权限:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lsusb</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo chmod a+rw /dev/ttyUSB0</span><br></pre></td></tr></table></figure>

<p>运行下面的代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">roslaunch rplidar_ros hector_mapping_demo.launch</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">roslaunch rplidar_ros rplidar.launch</span><br></pre></td></tr></table></figure>

<p><img src="/%E4%BD%BF%E7%94%A8jeston-nano-ros-melodic-RPLIDAR%E6%9E%84%E5%BB%BA%E5%9C%B0%E5%9B%BE/IMG_20220314_170322.jpg"></p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ROS-jeston-nano-RPLIDAR-SLAM/" rel="tag">ROS,jeston nano,RPLIDAR,SLAM</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-Jetson nano ubuntu18.04配置中文输入法"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2021/07/10/Jetson%20nano%20ubuntu18.04%E9%85%8D%E7%BD%AE%E4%B8%AD%E6%96%87%E8%BE%93%E5%85%A5%E6%B3%95/"
    >Jetson nano ubuntu18.04配置中文输入法</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2021/07/10/Jetson%20nano%20ubuntu18.04%E9%85%8D%E7%BD%AE%E4%B8%AD%E6%96%87%E8%BE%93%E5%85%A5%E6%B3%95/" class="article-date">
  <time datetime="2021-07-09T23:09:10.000Z" itemprop="datePublished">2021-07-10</time>
</a>    
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="一-检测是否有ibus"><a href="#一-检测是否有ibus" class="headerlink" title="一.检测是否有ibus"></a>一.检测是否有ibus</h1><p>在命令行输入</p>
<blockquote>
<p>ibus</p>
</blockquote>
<p>如果显示ibus的用法，则安装有ibus<br><img src="https://img-blog.csdnimg.cn/63b6e8c2d0bf4233a285405b8b911358.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBATW8teGll,size_20,color_FFFFFF,t_70,g_se,x_16" alt="请添加图片描述"></p>
<h1 id="二-安装pinyin"><a href="#二-安装pinyin" class="headerlink" title="二.安装pinyin"></a>二.安装pinyin</h1><p>安装ibus-pinyin</p>
<blockquote>
<p>sudo apt-get install ibus-pinyin</p>
</blockquote>
<h1 id="三-系统设置"><a href="#三-系统设置" class="headerlink" title="三.系统设置"></a>三.系统设置</h1><p>在系统设置中，点击“language support”<br><img src="https://img-blog.csdnimg.cn/54552d1a0c6645c08c2d9115bf0932d4.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBATW8teGll,size_19,color_FFFFFF,t_70,g_se,x_16"><br>点击“install &#x2F; remove language…”，选择简体中文，输入密码，此时系统会进行更新，大约几分钟，安装过程如下；<br><img src="https://img-blog.csdnimg.cn/e7203b23799143949de33016d7ecc5a9.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBATW8teGll,size_18,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>将汉语（中国）设置到首行，点击Apply System-Wide，并将keyboard input method system下拉选框选到ibus；<br><img src="https://img-blog.csdnimg.cn/93350c84221240bea7d6b7009bc9d980.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBATW8teGll,size_15,color_FFFFFF,t_70,g_se,x_16" alt="请添加图片描述"></p>
<h1 id="四-ibus设置"><a href="#四-ibus设置" class="headerlink" title="四.ibus设置"></a>四.ibus设置</h1><p>完成前面的操作后，需要重启一下，开机后命令行输入</p>
<blockquote>
<p>ibus restart<br>ibus-setup</p>
</blockquote>
<p>在你ibus设置里面，点击添加，选择汉语，有两个选项选择pinyin</p>
<p><img src="https://img-blog.csdnimg.cn/014e661015044f0b96de54afd1eda389.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBATW8teGll,size_20,color_FFFFFF,t_70,g_se,x_16" alt="请添加图片描述"></p>
<p>再输入下面的命令</p>
<blockquote>
<p>ibus restart</p>
</blockquote>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%8B%B1%E4%BC%9F%E8%BE%BEnano/" rel="tag">英伟达nano</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-ROS中工作空间和功能包的创建以及发布者Publisher的实现"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2021/06/18/ROS%E4%B8%AD%E5%B7%A5%E4%BD%9C%E7%A9%BA%E9%97%B4%E5%92%8C%E5%8A%9F%E8%83%BD%E5%8C%85%E7%9A%84%E5%88%9B%E5%BB%BA%E4%BB%A5%E5%8F%8A%E5%8F%91%E5%B8%83%E8%80%85Publisher%E7%9A%84%E5%AE%9E%E7%8E%B0/"
    >ROS中工作空间和功能包的创建以及发布者Publisher的实现</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2021/06/18/ROS%E4%B8%AD%E5%B7%A5%E4%BD%9C%E7%A9%BA%E9%97%B4%E5%92%8C%E5%8A%9F%E8%83%BD%E5%8C%85%E7%9A%84%E5%88%9B%E5%BB%BA%E4%BB%A5%E5%8F%8A%E5%8F%91%E5%B8%83%E8%80%85Publisher%E7%9A%84%E5%AE%9E%E7%8E%B0/" class="article-date">
  <time datetime="2021-06-18T11:15:24.000Z" itemprop="datePublished">2021-06-18</time>
</a>    
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <p>最近刚刚开始学习ROS，对于整个ROS的框架和功能正在一点点的了解，跟着B站古月居的《ROS入门21讲》课程，在安装好linux和ROS后，正式开始ROS的学习，动手实践敲代码，在这里先记录一下开始ROS项目的第一步，同时我安装的ROS版本为Noetic。<br>此次功能的实现是在ROS经典教程小乌龟运动上进行的。</p>
<h2 id="创建工作空间和功能包"><a href="#创建工作空间和功能包" class="headerlink" title="创建工作空间和功能包"></a>创建工作空间和功能包</h2><p>工作空间（worksspace）是一个存放工程开发相关文件的文件夹，咱们创建主文件夹catkin_ws，其中创建以下四个子文件夹：</p>
<blockquote>
<ul>
<li>src：代码空间（Source Space）</li>
<li>build：编译空间（Build Space）</li>
<li>devel：开发空间（Develpment Space）</li>
<li>install：安装空间（Install Space）</li>
</ul>
</blockquote>
<p>下面为实际操作：</p>
<h3 id="1-创建工作空间"><a href="#1-创建工作空间" class="headerlink" title="1.创建工作空间"></a>1.创建工作空间</h3><p>先在主目录里面创建catkin_ws文件夹,在主目录中打开终端。</p>
<pre><code>$  mkdir catkin_ws
</code></pre>
<p>也可以是别的目录，后面要设置一个环境变量，会用到已创建的工作空间里面的一个文件，如果不用主目录，在写文件路径的时候会比较麻烦。同时这个文件夹的文件不一定必须要命名为catkin_ws。但是上面所说的工作空间里面的四个文件夹，文件命名不能修改！</p>
<p>进入catkin_ws文件，创建src文件夹，这个文件夹是咱们一开始创建的，跟普通文件夹性质一样。</p>
<pre><code>$  cd catkin_ws
$  mkdir src
</code></pre>
<p>进入src文件夹。</p>
<pre><code>$  cd src
</code></pre>
<p>把当前的文件夹初始化，把他从一个普通的文件夹变成ROS的一个工作空间。</p>
<pre><code> $  catkin_init_workspace
</code></pre>
<p><img src="https://img-blog.csdnimg.cn/d8060ec2893f4ae1b946c268472bc4c0.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBATW8teGll,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<p>退回到catkin_ws文件夹。</p>
<pre><code>$  cd ..
</code></pre>
<p>下面是编译命令；这个是catkin工具提供的编译器的指令，编译src功能包里面的源码，然后结果放到devel和build文件夹里面。</p>
<pre><code>$  catkin_make
</code></pre>
<p><img src="https://img-blog.csdnimg.cn/b312de2f05eb4ba0b49720ebce98f674.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBATW8teGll,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<p>创建install文件夹，这个文件不会在工作空间初始化后自己生成，需要自己编译创建。</p>
<pre><code>$  catkin_make install
</code></pre>
<p><img src="https://img-blog.csdnimg.cn/01c6334781534d8aba6f954c8dcfb5fa.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBATW8teGll,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<p>目前在catkin_ws里面有四个文件夹，各自的功能如下：</p>
<blockquote>
<ul>
<li>src：:放置功能包的源码，后面Publisher发布的话题内容文件夹就放置在这个文件夹里面。</li>
<li>install：放置最终编译生成的可执行文件，这个文件可没有。</li>
<li>devel：开发空间，用于存放编译生成的目标文件，包括头文件、动态&amp;静态链接库、可执行文件，作用和install类似。</li>
<li>build：编译空间，放置编译的中间文件，二进制文件，存放CMake和catkin的缓存信息、配置信息和其他中间文件。</li>
</ul>
</blockquote>
<h3 id="2-创建功能包"><a href="#2-创建功能包" class="headerlink" title="2.创建功能包"></a>2.创建功能包</h3><p>进入src文件夹。</p>
<pre><code>$  cd ~/catkin_ws/src
</code></pre>
<p>创建功能包，名字为learning_topic，后面五个是依赖的五个工具包，可以用C++或者Python语言来写话题内容。</p>
<pre><code>$  catkin_create_pkg learning_topic roscpp rospy std_msgs geometry_msgs turtlesim
</code></pre>
<p><img src="https://img-blog.csdnimg.cn/b2c61fda16954524be9ac5587e5a2a2e.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBATW8teGll,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<h3 id="3-创建发布者代码"><a href="#3-创建发布者代码" class="headerlink" title="3.创建发布者代码"></a>3.创建发布者代码</h3><p>然后在catkin_ws&#x2F;src&#x2F;learning_topic&#x2F;src里面创建velocity_publisher.cpp文件，可以使用下面的命令：</p>
<pre><code>$  touch velocity_publisher.cpp
</code></pre>
<p>然后使用vim命令，打开这个文件夹。</p>
<pre><code>$  vim  velocity_publisher.cpp
</code></pre>
<p>把下面的代码复制粘贴上去，如果复制粘贴不上去，请看一下回头看一下linux命令，文件管理和编辑。或者直接右键：用文本编辑器打开。<br>下面的代码这次就不详细讲解了，只说一下大致的功能。大部分都有注释，代码在《古月ROS21讲》视频配套的文件里有，去古月居公众号找一下。另外这是C++语言的，因为在创建功能包的时候，咱们不光加入了C++的依赖也加入了Python的依赖，所以也可以使用Python编写，Python编写的整体风格要比C++简约的多。<br>在下面的代码中，实现了几个效果:</p>
<blockquote>
<ul>
<li>初始化ROS节点；</li>
<li>向ROS Master 注册节点信息，包括发布的话题名和话题中的消息类型；</li>
<li>创建消息数据；</li>
<li>按照一定频率循环发布消息。</li>
</ul>
</blockquote>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 该例程将发布turtle1/cmd_vel话题，消息类型geometry_msgs::Twist</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ros/ros.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;geometry_msgs/Twist.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> **argv)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">// ROS节点初始化</span></span><br><span class="line">	ros::<span class="built_in">init</span>(argc, argv, <span class="string">&quot;velocity_publisher&quot;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 创建节点句柄</span></span><br><span class="line">	ros::NodeHandle n;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 创建一个Publisher，发布名为/turtle1/cmd_vel的topic，消息类型为geometry_msgs::Twist，队列长度10</span></span><br><span class="line">	ros::Publisher turtle_vel_pub = n.<span class="built_in">advertise</span>&lt;geometry_msgs::Twist&gt;(<span class="string">&quot;/turtle1/cmd_vel&quot;</span>, <span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 设置循环的频率</span></span><br><span class="line">	<span class="function">ros::Rate <span class="title">loop_rate</span><span class="params">(<span class="number">10</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="type">int</span> count = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span> (ros::<span class="built_in">ok</span>())</span><br><span class="line">	&#123;</span><br><span class="line">	    <span class="comment">// 初始化geometry_msgs::Twist类型的消息</span></span><br><span class="line">		geometry_msgs::Twist vel_msg;</span><br><span class="line">		vel_msg.linear.x = <span class="number">0.5</span>;</span><br><span class="line">		vel_msg.angular.z = <span class="number">0.2</span>;</span><br><span class="line"></span><br><span class="line">	    <span class="comment">// 发布消息</span></span><br><span class="line">		turtle_vel_pub.<span class="built_in">publish</span>(vel_msg);</span><br><span class="line">		<span class="built_in">ROS_INFO</span>(<span class="string">&quot;Publsh turtle velocity command[%0.2f m/s, %0.2f rad/s]&quot;</span>, </span><br><span class="line">				vel_msg.linear.x, vel_msg.angular.z);</span><br><span class="line"></span><br><span class="line">	    <span class="comment">// 按照循环频率延时</span></span><br><span class="line">	    loop_rate.<span class="built_in">sleep</span>();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="4-配置发布者代码编译规则"><a href="#4-配置发布者代码编译规则" class="headerlink" title="4.配置发布者代码编译规则"></a>4.配置发布者代码编译规则</h3><p>在catkin_ws&#x2F;src&#x2F;learning_topic&#x2F;CMakeLists.txt中加入以下代码，位置是在CMakeLists.txt中的install标题上面。</p>
<pre><code>    add_executable(velocity_publisher src/velocity_publisher.cpp)
    target_link_libraries(velocity_publisher $&#123;catkin_LIBRARIES&#125;)
</code></pre>
<p>add_executable这个函数是把velocity_publisher.cpp文件编译成可执行文件velocity_publisher。<br>target_link_libraries函数把上面生成的可执行文件velocity_publisher和ROS相关的库作链接，像是C++、Python库</p>
<h3 id="5-编译并运行发布者"><a href="#5-编译并运行发布者" class="headerlink" title="5.编译并运行发布者"></a>5.编译并运行发布者</h3><p>咱们再回到catkin_ws文件夹:</p>
<pre><code>$  cd ~/catkin_ws
</code></pre>
<p>进行编译:</p>
<pre><code>$  catkin_make
</code></pre>
<p><img src="https://img-blog.csdnimg.cn/336ca6d81c254331b2850174f72f4d9d.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBATW8teGll,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<p>随后需要设置环境变量：</p>
<pre><code>$  source devel/setup.bash
</code></pre>
<p>如果不想每次执行这个文件，配置环境变量 ，在主目录下按快捷键Ctrl+H，显示出隐藏的文件，在.bashrc文件里面的最后加上</p>
<pre><code>echo &quot;source /home/yzxie/catkin_ws/devel/setup.bash&quot;&gt;&gt; ~/.bashrc

或者

source /home/yzxie/catkin_ws/devel/setup.bash
</code></pre>
<p>这里注意第二行代码中，&#x2F;home意思是在主目录里面，如果你一开始catkin_ws文件不是创建在主目录下，这里就要盖面路径，&#x2F;yzxie&#x2F;是你linux系统的用户名。</p>
<p>随后重新打开终端，输入一下命令;</p>
<pre><code>$  roscore
</code></pre>
<p><img src="https://img-blog.csdnimg.cn/aebb03d8702e47bda3718bdb0b8e0928.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBATW8teGll,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<p>不要关闭，Ctri+Atl+T再重新打开一个终端，输入以下命令：</p>
<pre><code>$  rosrun turtlesim turtlesim_node
</code></pre>
<p><img src="https://img-blog.csdnimg.cn/2d63fd92f26141a2a58c282b83d97bf7.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBATW8teGll,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<p>运行之后就会看到小乌龟的界面,小海龟的皮肤每次都是随机，每次都像开盲盒。然后Ctri+Atl+T再重新打开一个终端，输入以下命令：</p>
<pre><code>$  rosrun learning_topic velocity_publisher
</code></pre>
<p><img src="https://img-blog.csdnimg.cn/d298939811e044929fb87b6fd3d0269f.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBATW8teGll,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>然后小乌龟就按照咱们C++程序中设定的，以一定的角速度旋转，咱们的整个功能也就实现了。</p>
<p>​        </p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ROS%E3%80%81C/" rel="tag">ROS、C++</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-在ROS中使用C++中，ros_ros.h报错_找不到"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2021/06/17/%E5%9C%A8ROS%E4%B8%AD%E4%BD%BF%E7%94%A8C++%E4%B8%AD%EF%BC%8Cros_ros.h%E6%8A%A5%E9%94%99_%E6%89%BE%E4%B8%8D%E5%88%B0/"
    >在ROS中使用C++中，ros_ros.h报错_找不到</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2021/06/17/%E5%9C%A8ROS%E4%B8%AD%E4%BD%BF%E7%94%A8C++%E4%B8%AD%EF%BC%8Cros_ros.h%E6%8A%A5%E9%94%99_%E6%89%BE%E4%B8%8D%E5%88%B0/" class="article-date">
  <time datetime="2021-06-17T01:45:37.000Z" itemprop="datePublished">2021-06-17</time>
</a>    
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <p>功能包的vscode文件夹下的c_cpp_properties.json内容替换为：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;configurations&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;browse&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;databaseFilename&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="string">&quot;limitSymbolsToIncludedHeaders&quot;</span>: true</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="string">&quot;includePath&quot;</span>: [</span><br><span class="line">        <span class="string">&quot;$&#123;workspaceFolder&#125;/**&quot;</span>,</span><br><span class="line">        <span class="string">&quot;/opt/ros/noetic/include/**&quot;</span>,</span><br><span class="line">        <span class="string">&quot;/usr/include/**&quot;</span>,</span><br><span class="line">        <span class="string">&quot;/usr/local/include/**&quot;</span></span><br><span class="line">      ],</span><br><span class="line">      <span class="string">&quot;name&quot;</span>: <span class="string">&quot;ROS&quot;</span>,</span><br><span class="line">      <span class="string">&quot;intelliSenseMode&quot;</span>: <span class="string">&quot;linux-gcc-x64&quot;</span>,</span><br><span class="line">      <span class="string">&quot;compilerPath&quot;</span>: <span class="string">&quot;/usr/bin/gcc&quot;</span>,</span><br><span class="line">      <span class="string">&quot;cStandard&quot;</span>: <span class="string">&quot;c11&quot;</span>,</span><br><span class="line">      <span class="string">&quot;cppStandard&quot;</span>: <span class="string">&quot;c++17&quot;</span>,</span><br><span class="line">      <span class="string">&quot;compilerArgs&quot;</span>: []</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="string">&quot;version&quot;</span>: <span class="number">4</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>settings.json文件内的内容替换为：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    // 有关 tasks.json 格式的文档，请参见</span><br><span class="line">        // https://go.microsoft.com/fwlink/?LinkId=<span class="number">733558</span></span><br><span class="line">        <span class="string">&quot;version&quot;</span>: <span class="string">&quot;2.0.0&quot;</span>,</span><br><span class="line">        <span class="string">&quot;tasks&quot;</span>: [</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="string">&quot;label&quot;</span>: <span class="string">&quot;catkin_make:debug&quot;</span>, //代表提示的描述性信息</span><br><span class="line">                <span class="string">&quot;type&quot;</span>: <span class="string">&quot;shell&quot;</span>,  //可以选择shell或者process,如果是shell代码是在shell里面运行一个命令，如果是process代表作为一个进程来运行</span><br><span class="line">                <span class="string">&quot;command&quot;</span>: <span class="string">&quot;catkin_make&quot;</span>,//这个是我们需要运行的命令</span><br><span class="line">                <span class="string">&quot;args&quot;</span>: [],//如果需要在命令后面加一些后缀，可以写在这里，比如-DCATKIN_WHITELIST_PACKAGES=“pac1;pac2”</span><br><span class="line">                <span class="string">&quot;group&quot;</span>: &#123;<span class="string">&quot;kind&quot;</span>:<span class="string">&quot;build&quot;</span>,<span class="string">&quot;isDefault&quot;</span>:true&#125;,</span><br><span class="line">                <span class="string">&quot;presentation&quot;</span>: &#123;</span><br><span class="line">                    <span class="string">&quot;reveal&quot;</span>: <span class="string">&quot;always&quot;</span>//可选always或者silence，代表是否输出信息</span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="string">&quot;problemMatcher&quot;</span>: <span class="string">&quot;$msCompile&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">        ],</span><br><span class="line">        <span class="string">&quot;python.autoComplete.extraPaths&quot;</span>: [</span><br><span class="line">            <span class="string">&quot;/opt/ros/noetic/lib/python3/dist-packages&quot;</span></span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ROS%E3%80%81C/" rel="tag">ROS、C++</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-用LBPH、FisherFaces与EignFaces算法进行人脸识别"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2021/06/15/%E7%94%A8LBPH%E3%80%81FisherFaces%E4%B8%8EEignFaces%E7%AE%97%E6%B3%95%E8%BF%9B%E8%A1%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/"
    >用LBPH、FisherFaces与EignFaces算法进行人脸识别</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2021/06/15/%E7%94%A8LBPH%E3%80%81FisherFaces%E4%B8%8EEignFaces%E7%AE%97%E6%B3%95%E8%BF%9B%E8%A1%8C%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/" class="article-date">
  <time datetime="2021-06-15T00:35:17.000Z" itemprop="datePublished">2021-06-15</time>
</a>    
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <p>人脸识别就是找到一个可以表征每个人脸特征的模型，在进行识别是先提取当人脸的特征，再从已有的特征集这种找到最为接近的人脸样本，从而得到当前人脸的标签。<br>在如今的世界，人脸识别也变得越来越重要，应用越来越广泛，比如人脸识别可用于身份认证、摄影、支付、视频等领域。<br>在Opencv中提供了LPBH、EigenFishfaces和FisherFace三种人脸识别方法。</p>
<h1 id="一、LBPH算法"><a href="#一、LBPH算法" class="headerlink" title="一、LBPH算法"></a>一、LBPH算法</h1><p>LBPH所使用的模型基于LBP算法，其基本原理是将图像（灰度图，如果是彩色图则先转为灰度图）中某个像素点的值与其最临近的3×3邻域8个像素点的值逐一比较，如果该点像素值大于其邻近点的像素值，则得到0，反之，如果该点像素值小于其临界点的像素值，则得到1，最后，将该像素点与其周围8个像素点比较所得到的0和1组合，并依次排列，得到一个8位的二进制序列，将该二进制序列转换为十进制数作为该像素点的LBP值。<br>      <img src="https://img-blog.csdnimg.cn/d6388e02707b4d6585b5ffee1e46a5d9.png" alt="在这里插入图片描述"> </p>
<p>上述是原始的LBPH 算法，后续又有人将其改进，将3×3邻域拓展到任意区域，并用圆形代替了正方形邻域，改进后的 LBP 算子允许在半径为 R 的圆形邻域内有任意多个像素点。从而得到了诸如半径为R的圆形区域内含有P个采样点的LBP算子。<br><img src="https://img-blog.csdnimg.cn/e9b8c311e229482299274c0c5c6f20bd.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBATW8teGll,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>以下是LBPH特征提取的C++代码：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;opencv2\opencv.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;opencv2\imgproc\types_c.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> cv;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>** argv)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	Mat src, gray_src;</span><br><span class="line">	src = <span class="built_in">imread</span>(<span class="string">&quot;E:\\picture\\1.png&quot;</span>);</span><br><span class="line">	<span class="keyword">if</span> (src.<span class="built_in">empty</span>())</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;could not read image ... &quot;</span> &lt;&lt; endl;</span><br><span class="line">		<span class="built_in">getchar</span>();</span><br><span class="line">		<span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//namedWindow(&quot;input image&quot;, CV_WINDOW_AUTOSIZE);</span></span><br><span class="line">	<span class="built_in">imshow</span>(<span class="string">&quot;input image&quot;</span>, src);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">cvtColor</span>(src, gray_src, CV_BGR2GRAY);</span><br><span class="line">	<span class="comment">//cvtColor(src, gray_src,10);</span></span><br><span class="line">	<span class="type">int</span> width = gray_src.cols;</span><br><span class="line">	<span class="type">int</span> height = gray_src.rows;</span><br><span class="line"></span><br><span class="line">	Mat lbpImage = Mat::<span class="built_in">zeros</span>(height - <span class="number">2</span>, width - <span class="number">2</span>, CV_8SC1);</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> row = <span class="number">1</span>; row &lt; height - <span class="number">1</span>; row++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> col = <span class="number">1</span>; col &lt; width - <span class="number">1</span>; col++)</span><br><span class="line">		&#123;</span><br><span class="line">			uchar c = gray_src.<span class="built_in">at</span>&lt;uchar&gt;(row, col);</span><br><span class="line">			uchar code = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">			code |= (gray_src.<span class="built_in">at</span>&lt;uchar&gt;(row - <span class="number">1</span>, col - <span class="number">1</span>) &gt; c) &lt;&lt; <span class="number">7</span>;</span><br><span class="line">			code |= (gray_src.<span class="built_in">at</span>&lt;uchar&gt;(row - <span class="number">1</span>, col    ) &gt; c) &lt;&lt; <span class="number">6</span>;</span><br><span class="line">			code |= (gray_src.<span class="built_in">at</span>&lt;uchar&gt;(row - <span class="number">1</span>, col + <span class="number">1</span>) &gt; c) &lt;&lt; <span class="number">5</span>;</span><br><span class="line">			code |= (gray_src.<span class="built_in">at</span>&lt;uchar&gt;(row    , col + <span class="number">1</span>) &gt; c) &lt;&lt; <span class="number">4</span>;</span><br><span class="line">			code |= (gray_src.<span class="built_in">at</span>&lt;uchar&gt;(row + <span class="number">1</span>, col + <span class="number">1</span>) &gt; c) &lt;&lt; <span class="number">3</span>;</span><br><span class="line">			code |= (gray_src.<span class="built_in">at</span>&lt;uchar&gt;(row + <span class="number">1</span>, col    ) &gt; c) &lt;&lt; <span class="number">2</span>;</span><br><span class="line">			code |= (gray_src.<span class="built_in">at</span>&lt;uchar&gt;(row + <span class="number">1</span>, col - <span class="number">1</span>) &gt; c) &lt;&lt; <span class="number">1</span>;</span><br><span class="line">			code |= (gray_src.<span class="built_in">at</span>&lt;uchar&gt;(row    , col - <span class="number">1</span>) &gt; c) &lt;&lt; <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">			lbpImage.<span class="built_in">at</span>&lt;uchar&gt;(row - <span class="number">1</span>, col - <span class="number">1</span>) = code;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">imshow</span>(<span class="string">&quot;output image&quot;</span>, gray_src);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">waitKey</span>(<span class="number">0</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/9f5404b7def34c47bcc0c0284bc6c7f5.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBATW8teGll,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>右图是原图像，左图是经过LBPH特征提取输出图像。</p>
<p>如果将以上得到的LBPH图直接用于人脸识别，其实和不提取LBP特征没什么区别，在实际的LBP应用中一般采用LBPH特征谱的统计直方图作为特征向量进行分类识别，并且可以将一幅图片划分为若干的子区域，对每个子区域内的每个像素点都提取LBP特征，然后，在每个子区域内建立LBPH特征的统计直方图。</p>
<p>如此一来，每个子区域，就可以用一个统计直方图来进行描述，整个图片就由若干个统计直方图组成，这样做的好处是在一定范围内减小图像没完全对准而产生的误差，分区的另外一个意义在于我们可以根据不同的子区域给予不同的权重，比如说我们认为中心部分分区的权重大于边缘部分分区的权重，意思就是说中心部分在进行图片匹配识别时的意义更为重大。</p>
<p> 例如：一幅100×100像素大小的图片，划分为10×10&#x3D;100个子区域（可以通过多种方式来划分区域），每个子区域的大小为10×10像素；在每个子区域内的每个像素点，提取其LBP特征，然后，建立统计直方图；这样，这幅图片就有10×10个子区域，也就有了10×10个统计直方图，利用这10×10个统计直方图，就可以描述这幅图片了。之后，我们利用各种相似性度量函数，就可以判断两幅图像之间的相似性了。关于相似度度量函数，跟人脸识别一样有很多方法，在这就不逐一分析了，知道LBPH的原理就可以。</p>
<p>以下是LBPH人脸识别的Python实现：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#导入库</span></span><br><span class="line"><span class="keyword">import</span> cv2 <span class="keyword">as</span> cv</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment">#创建记录读取的训练数据集的列表</span></span><br><span class="line">images = []</span><br><span class="line"></span><br><span class="line"><span class="comment">#往列表里添加训练集图片,这里的地址根据数据集在你电脑上放置的位置进行修改，数目可以增加，数目越多识别准确度越高。</span></span><br><span class="line">images.append(cv.imread(<span class="string">&quot;E:/picture/11.png&quot;</span>, cv.IMREAD_GRAYSCALE))</span><br><span class="line">images.append(cv.imread(<span class="string">&quot;E:/picture/12.png&quot;</span>, cv.IMREAD_GRAYSCALE))</span><br><span class="line">images.append(cv.imread(<span class="string">&quot;E:/picture/13.png&quot;</span>, cv.IMREAD_GRAYSCALE))</span><br><span class="line">images.append(cv.imread(<span class="string">&quot;E:/picture/21.png&quot;</span>, cv.IMREAD_GRAYSCALE))</span><br><span class="line">images.append(cv.imread(<span class="string">&quot;E:/picture/22.png&quot;</span>, cv.IMREAD_GRAYSCALE))</span><br><span class="line">images.append(cv.imread(<span class="string">&quot;E:/picture/23.png&quot;</span>, cv.IMREAD_GRAYSCALE))</span><br><span class="line"></span><br><span class="line"><span class="comment">#创建标签</span></span><br><span class="line">labels = [<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">#利用opencv中的FisherFace算法，生成Fisher识别器模型</span></span><br><span class="line">recognizer = cv.face.LBPHFaceRecognizer_create()</span><br><span class="line"></span><br><span class="line"><span class="comment">#训练数据集</span></span><br><span class="line">recognizer.train(images,np.array(labels))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#读取待检测的图像</span></span><br><span class="line">predict_image1 = cv.imread(<span class="string">&quot;E:/picture/1.png&quot;</span>,cv.IMREAD_GRAYSCALE)</span><br><span class="line">predict_image2 = cv.imread(<span class="string">&quot;E:/picture/2.png&quot;</span>,cv.IMREAD_GRAYSCALE)</span><br><span class="line"></span><br><span class="line"><span class="comment">#识别图像</span></span><br><span class="line">label1,configence1 = recognizer.predict(predict_image1)</span><br><span class="line">label2,configence2 = recognizer.predict(predict_image2)</span><br><span class="line"></span><br><span class="line"><span class="comment">#输出识别结果</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;label1= &quot;</span>,label1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;confidence1= &quot;</span>,configence1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;label2= &quot;</span>,label1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;confidence2= &quot;</span>,configence1)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>数据集：<br><img src="https://img-blog.csdnimg.cn/f8fb48dae7b24aaf9a1dc012af4c61f5.png" alt="在这里插入图片描述"><br>结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">label1=  <span class="number">0</span></span><br><span class="line">confidence1=  <span class="number">31.010053777159456</span></span><br><span class="line">label2=  <span class="number">0</span></span><br><span class="line">confidence2=  <span class="number">31.010053777159456</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="二、用FisherFace与EignFaces算法进行人脸识别"><a href="#二、用FisherFace与EignFaces算法进行人脸识别" class="headerlink" title="二、用FisherFace与EignFaces算法进行人脸识别"></a>二、用FisherFace与EignFaces算法进行人脸识别</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#导入库</span></span><br><span class="line"><span class="keyword">import</span> cv2 <span class="keyword">as</span> cv</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment">#创建记录读取的训练数据集的列表</span></span><br><span class="line">images = []</span><br><span class="line"></span><br><span class="line"><span class="comment">#往列表里添加训练集图片,这里的地址根据数据集在你电脑上放置的位置进行修改，数目可以增加，数目越多识别准确度越高。</span></span><br><span class="line">images.append(cv.imread(<span class="string">&quot;E:/picture/11.png&quot;</span>, cv.IMREAD_GRAYSCALE))</span><br><span class="line">images.append(cv.imread(<span class="string">&quot;E:/picture/12.png&quot;</span>, cv.IMREAD_GRAYSCALE))</span><br><span class="line">images.append(cv.imread(<span class="string">&quot;E:/picture/13.png&quot;</span>, cv.IMREAD_GRAYSCALE))</span><br><span class="line">images.append(cv.imread(<span class="string">&quot;E:/picture/21.png&quot;</span>, cv.IMREAD_GRAYSCALE))</span><br><span class="line">images.append(cv.imread(<span class="string">&quot;E:/picture/22.png&quot;</span>, cv.IMREAD_GRAYSCALE))</span><br><span class="line">images.append(cv.imread(<span class="string">&quot;E:/picture/23.png&quot;</span>, cv.IMREAD_GRAYSCALE))</span><br><span class="line"></span><br><span class="line"><span class="comment">#创建标签</span></span><br><span class="line">labels = [<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">#利用opencv中的FisherFace算法，生成Fisher识别器模型</span></span><br><span class="line">recognizer1 = cv.face.FisherFaceRecognizer_create()</span><br><span class="line"><span class="comment">#利用opencv中的EigenFace算法，生成Eign识别器模型</span></span><br><span class="line">recognizer2 = cv.face.EigenFaceRecognizer_create()</span><br><span class="line"></span><br><span class="line"><span class="comment">#训练数据集</span></span><br><span class="line">recognizer1.train(images,np.array(labels))</span><br><span class="line">recognizer2.train(images,np.array(labels))</span><br><span class="line"></span><br><span class="line"><span class="comment">#读取待检测的图像</span></span><br><span class="line">predict_image1 = cv.imread(<span class="string">&quot;E:/picture/1.png&quot;</span>,cv.IMREAD_GRAYSCALE)</span><br><span class="line">predict_image2 = cv.imread(<span class="string">&quot;E:/picture/2.png&quot;</span>,cv.IMREAD_GRAYSCALE)</span><br><span class="line"></span><br><span class="line"><span class="comment">#识别图像</span></span><br><span class="line">label1,configence1 = recognizer1.predict(predict_image1)</span><br><span class="line">label2,configence2 = recognizer2.predict(predict_image2)</span><br><span class="line"></span><br><span class="line"><span class="comment">#输出识别结果</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;label1= &quot;</span>,label1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;confidence1= &quot;</span>,configence1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;label2= &quot;</span>,label2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;confidence2= &quot;</span>,configence2)</span><br></pre></td></tr></table></figure>

<p>此代码使用的数据集和上面LBPH算法使用的一样，输出结果为：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">label1=  <span class="number">0</span></span><br><span class="line">confidence1=  <span class="number">3683.4028152276414</span></span><br><span class="line">label2=  <span class="number">1</span></span><br><span class="line">confidence2=  <span class="number">4493.339622323507</span></span><br></pre></td></tr></table></figure>
<p>如果在用以上Python代码实现人脸识别的时候，出现一下错误：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">&quot;C:/Users/13611/Desktop/import cv2.py&quot;</span>, line <span class="number">25</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">    recognizer1.train(images,np.array(labels))</span><br><span class="line">cv2.error: OpenCV(<span class="number">4.0</span><span class="number">.1</span>) C:\ci\opencv-suite_1573470242804\work\opencv_contrib-<span class="number">4.0</span><span class="number">.1</span>\modules\face\src\fisher_faces.cpp:<span class="number">81</span>: error: (-<span class="number">210</span>:Unsupported <span class="built_in">format</span> <span class="keyword">or</span> combination of formats) In the Fisherfaces method <span class="built_in">all</span> <span class="built_in">input</span> samples (training images) must be of equal size! Expected <span class="number">111000</span> pixels, but was <span class="number">53088</span> pixels. <span class="keyword">in</span> function <span class="string">&#x27;cv::face::Fisherfaces::train&#x27;</span></span><br></pre></td></tr></table></figure>
<p>这是数据集这几张图片像素大小不一样，是用截图或者ps修改一下，也可以给我留言，给我要一下我使用的数据集。</p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/OpenCV%E3%80%81%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/" rel="tag">OpenCV、人脸识别</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-ROS工作空间的文件组成及其功能"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2021/06/10/ROS%E5%B7%A5%E4%BD%9C%E7%A9%BA%E9%97%B4%E7%9A%84%E6%96%87%E4%BB%B6%E7%BB%84%E6%88%90%E5%8F%8A%E5%85%B6%E5%8A%9F%E8%83%BD/"
    >ROS工作空间的文件组成及其功能</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2021/06/10/ROS%E5%B7%A5%E4%BD%9C%E7%A9%BA%E9%97%B4%E7%9A%84%E6%96%87%E4%BB%B6%E7%BB%84%E6%88%90%E5%8F%8A%E5%85%B6%E5%8A%9F%E8%83%BD/" class="article-date">
  <time datetime="2021-06-10T05:34:32.000Z" itemprop="datePublished">2021-06-10</time>
</a>    
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <p><img src="https://img-blog.csdnimg.cn/93b06bc7e6ef4726a3b3393d9971a0ec.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBATW8teGll,size_20,color_FFFFFF,t_70,g_se,x_16" alt="请添加图片描述"></p>
<h1 id="catkin-workspace"><a href="#catkin-workspace" class="headerlink" title="catkin workspace"></a>catkin workspace</h1><p>自定义的工作空间</p>
<h2 id="src"><a href="#src" class="headerlink" title="src"></a>src</h2><h3 id="放置源码"><a href="#放置源码" class="headerlink" title="放置源码"></a>放置源码</h3><ul>
<li><p>package1</p>
<ul>
<li><p>功能包（ROS基本单元）包含多个节点、库与配置文件，包含所有字母小写，只能由字母、数字与下划线组成。</p>
<ul>
<li><p>CMakeList.txt</p>
<ul>
<li>配置编译规则，比如源文件、依赖项、目标文件</li>
</ul>
</li>
<li><p>package.xml</p>
<ul>
<li>包信息，包括：包名、版本、依赖项</li>
</ul>
</li>
<li><p>msg</p>
<ul>
<li><p>消息通信格式文件</p>
<ul>
<li>*.msg</li>
</ul>
</li>
</ul>
</li>
<li><p>srv</p>
<ul>
<li><p>服务通信格式文件</p>
<ul>
<li>*.srv</li>
</ul>
</li>
</ul>
</li>
<li><p>include</p>
<ul>
<li><p>源文件</p>
<ul>
<li>*.h</li>
</ul>
</li>
</ul>
</li>
<li><p>launch</p>
<ul>
<li>可一次性运行多个节点</li>
</ul>
</li>
<li><p>scripts</p>
<ul>
<li><p>储存python文件</p>
<ul>
<li>*.py</li>
<li>*.sh</li>
</ul>
</li>
</ul>
</li>
<li><p>src</p>
<ul>
<li><p>储存C++源文件</p>
<ul>
<li>*.cpp</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>CMakeLists.txt</p>
<ul>
<li>编译的基本配置</li>
</ul>
</li>
</ul>
<h2 id="build"><a href="#build" class="headerlink" title="build"></a>build</h2><h3 id="编译空间，用于存放CMake和catkin的缓存信息、配置信息和其他中间文件。"><a href="#编译空间，用于存放CMake和catkin的缓存信息、配置信息和其他中间文件。" class="headerlink" title="编译空间，用于存放CMake和catkin的缓存信息、配置信息和其他中间文件。"></a>编译空间，用于存放CMake和catkin的缓存信息、配置信息和其他中间文件。</h3><h2 id="devel"><a href="#devel" class="headerlink" title="devel"></a>devel</h2><h3 id="开发空间，用于存放编译后生成的目标文件，包括头文件、动态-amp-静态链接库、可执行文件等。"><a href="#开发空间，用于存放编译后生成的目标文件，包括头文件、动态-amp-静态链接库、可执行文件等。" class="headerlink" title="开发空间，用于存放编译后生成的目标文件，包括头文件、动态&amp;静态链接库、可执行文件等。"></a>开发空间，用于存放编译后生成的目标文件，包括头文件、动态&amp;静态链接库、可执行文件等。</h3> 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ROS%E3%80%81C/" rel="tag">ROS、C++</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-STM32寄存器点亮LED（什么是寄存器、GPIO工作方式、点亮原理）"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2021/05/05/STM32%E5%AF%84%E5%AD%98%E5%99%A8%E7%82%B9%E4%BA%AELED%EF%BC%88%E4%BB%80%E4%B9%88%E6%98%AF%E5%AF%84%E5%AD%98%E5%99%A8%E3%80%81GPIO%E5%B7%A5%E4%BD%9C%E6%96%B9%E5%BC%8F%E3%80%81%E7%82%B9%E4%BA%AE%E5%8E%9F%E7%90%86%EF%BC%89/"
    >STM32寄存器点亮LED（什么是寄存器、GPIO工作方式、点亮原理）</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2021/05/05/STM32%E5%AF%84%E5%AD%98%E5%99%A8%E7%82%B9%E4%BA%AELED%EF%BC%88%E4%BB%80%E4%B9%88%E6%98%AF%E5%AF%84%E5%AD%98%E5%99%A8%E3%80%81GPIO%E5%B7%A5%E4%BD%9C%E6%96%B9%E5%BC%8F%E3%80%81%E7%82%B9%E4%BA%AE%E5%8E%9F%E7%90%86%EF%BC%89/" class="article-date">
  <time datetime="2021-05-05T10:55:17.000Z" itemprop="datePublished">2021-05-05</time>
</a>    
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="一、什么是寄存器"><a href="#一、什么是寄存器" class="headerlink" title="一、什么是寄存器"></a>一、什么是寄存器</h1><p>&amp;emsp; STM32编程通常有两种编程方法，一种是寄存器编程；另一种是固件库编程，其中寄存器编程是基础，而固件库编程是在寄存器编程的基础上升级而来的一种易于学习和开发的方法，是学习STM32编程时需重点掌握的一种编程方法。而固件库编程对于项目开发固然简单和快速，但是从学习的角度出发，寄存器编程的方法也不能不掌握。其实我们在学习8位单片机的时候，像是MSC-51单片机，就是采用寄存器编程。</p>
<h1 id="二、GPIO框图剖析"><a href="#二、GPIO框图剖析" class="headerlink" title="二、GPIO框图剖析"></a>二、GPIO框图剖析</h1><p>&amp;emsp; GPIO是通用输入输出口端口的简称，简单就是来说就是STM32可控制引脚。将STM32芯片引脚与外部设备连接起来，即可实现与外部通信、控制以及数据采集的功能。</p>
<p>&amp;emsp; 通过GPIO硬件结构框图，就可以从整体上深入了解GPIO外设及它的各种应用模式。从最右端看起，最右端就是代表STM32芯片引出的GPIO引脚，其余部件都位于芯片内部。<br><img src="https://img-blog.csdnimg.cn/ad624ed6e64f4aada7acad74f610ac4a.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAYW50aG9ueS0zNg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="请添加图片描述"></p>
<h2 id="2-1-基本结构分析"><a href="#2-1-基本结构分析" class="headerlink" title="2.1 基本结构分析"></a>2.1 基本结构分析</h2><p>&amp;emsp; 下面我们按上图中的编号对GPIO端口的结构部件进行说明。</p>
<p>①保护二极管及上、下拉电阻<br>&amp;emsp; 引脚的两个保护二极管可以防止引脚外部过高或过低的电压输入，当引脚电压高于VDD时，上方的二极管导通，当引脚电压低于VSS时，下方的二极管导通，防止不正常电压引入芯片导致芯片烧毁。尽管有这样的保护，并不意味着STM32的引脚能直接外接大功率驱动器件，如直接驱动电机，要么电机不转，要么导致芯片烧坏，必须要加大功率及隔离电路驱动。</p>
<p>②P-MOS管和N-MOS管<br>&amp;emsp; GPIO引脚线路经过两个保护二极管后，向上流向“输入模式”结构，向下流向“输出模式”结构。先看输出模式部分，线路经过一个由P-MOS和N-MOS管组成的单元电路。这个结构使GPIO具有了“推挽输出”和“开漏输出”两种模式。</p>
<p>&amp;emsp; 所谓推挽输出模式，是根据这两个MOS管的工作方式来命名的。在该结构中输入高电平时，经过反向后，上方的P-MOS导通，下方的N-MOS关闭，对外输出高电平；而在该结构中输入低电平时，经过反向后，N-MOS管导通，P-MOS关闭，对外输出低电平。当引脚高低电平切换时，两个MOS管轮流导通，P管负责灌电流，N管负责拉电流，使其负载能力和开关速度都比普通的方式有很大的提高。推挽输出的低电平为0V，高电平为3.3V，推挽输出模式时的等效电路见图。<br><img src="https://img-blog.csdnimg.cn/26ddafff449c439ba607ca1edb5ed3f1.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAYW50aG9ueS0zNg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="请添加图片描述"><br>&amp;emsp; 而在开漏输出模式时，上方的P-MOS管完全不工作。如果我们控制输出为0，低电平，则P-MOS管关闭，N-MOS管导通，使输出接地，若控制输出为1（它无法直接输出高电平）时，则P-MOS管和N-MOS管都关闭，所以引脚既不输出高电平，也不输出低电平，为高阻态。正常使用时必须外部接上拉电阻，等效电路见图7-3。它具有“线与”特性，也就是说，若有很多个开漏模式引脚连接到一起时，只有当所有引脚都输出高阻态，才由上拉电阻提供高电平，此高电平的电压为外部上拉电阻所接的电源的电压。若其中一个引脚为低电平，那线路就相当于短路接地，使得整条线路都为低电平，0V。<img src="https://img-blog.csdnimg.cn/0e0111537816468cb66d720435751839.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAYW50aG9ueS0zNg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="请添加图片描述"><br>&amp;emsp; &amp;emsp; 推挽输出模式一般应用在输出电平为0和3.3V而且需要高速切换开关状态的场合。在STM32的应用中，除了必须用开漏模式的场合，一般习惯使用推挽输出模式。</p>
<p>&amp;emsp; 开漏输出一般应用在I2C、SMBUS通信等需要“线与”功能的总线电路中。除此之外，还用在电平不匹配的场合，如需要输出5V的高电平，就可以在外部接一个上拉电阻，上拉电源为5V，并且把GPIO设置为开漏模式，当输出高阻态时，由上拉电阻和电源向外输出5V的电平，具体见图。<br><img src="https://img-blog.csdnimg.cn/2ce07e94cedb43309265b95a6bb027be.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAYW50aG9ueS0zNg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="请添加图片描述"><br>③输出数据寄存器<br>&amp;emsp; 前面提到的双MOS管结构电路的输入信号，是由GPIO“输出数据寄存器GPIOx_ODR”提供的，因此我们通过修改输出数据寄存器的值，就可以修改GPIO引脚的输出电平。而“置位&#x2F;复位寄存器GPIOx_BSRR”可以通过修改输出数据寄存器的值，从而影响电路的输出。<br>④复用功能输出<br>&amp;emsp; “复用功能输出”中的“复用”是指STM32的其他片上外设对GPIO引脚进行控制，此时GPIO引脚用作该外设功能的一部分，算是第二用途。从其他外设引出来的“复用功能输出信号”与GPIO本身的数据寄存器都连接到双MOS管结构的输入中，将图7-1中的梯形结构作为开关切换选择。<br>&amp;emsp; 例如我们使用USART串口通信时，需要用到某个GPIO引脚作为通信发送引脚，这个时候就可以把该GPIO引脚配置成USART串口复用功能，由串口外设控制该引脚，发送数据。<br>⑤输入数据寄存器<br>&amp;emsp; 看GPIO结构框图的上半部分，GPIO引脚经过内部的上、下拉电阻，可以配置成上&#x2F;下拉输入，然后再连接到肖特基触发器，信号经过触发器后，模拟信号转化为0、1的数字信号，然后存储在“输入数据寄存器GPIOx_IDR”中，通过读取该寄存器就可以了解GPIO引脚的电平状态。<br>⑥复用功能输入<br>&amp;emsp;与“复用功能输出”模式类似，在“复用功能输入模式”时，GPIO引脚的信号传输到STM32其他片上外设，由该外设读取引脚状态。<br>同样，如我们使用USART串口通信时，需要用到某个GPIO引脚作为通信接收引脚，这个时候就可以把该GPIO引脚配置成USART串口复用功能，使USART可以通过该通信引脚的接收远端数据。<br>⑦模拟输入输出<br>&amp;emsp;当GPIO引脚用于ADC采集电压的输入通道时，用作“模拟输入”功能，此时信号是不经过肖特基触发器的，因为经过肖特基触发器后信号只有0、1两种状态，所以ADC外设要采集到原始的模拟信号，信号源输入必须在肖特基触发器之前。类似地，当GPIO引脚用于DAC作为模拟电压输出通道时，此时作为“模拟输出”功能，DAC的模拟信号输出就不经过双MOS管结构，而是直接输出到引脚。</p>
<h2 id="2-2GPIO工作模式"><a href="#2-2GPIO工作模式" class="headerlink" title="2.2GPIO工作模式"></a>2.2GPIO工作模式</h2><p>&amp;emsp;在固件库中，GPIO总共有8种细分的工作模式，稍加整理可以大致归类为以下3类。<br>①输入模式（模拟&#x2F;浮空&#x2F;上拉&#x2F;下拉）<br>&amp;emsp;在输入模式时，肖特基触发器打开，输出被禁止，可通过输入数据寄存器GPIOx_IDR读取I&#x2F;O状态。其中输入模式可设置为上拉、下拉、浮空和模拟4种。上拉和下拉输入很好理解，默认的电平由上拉或者下拉决定。浮空输入的电平是不确定的，完全由外部的输入决定，一般接按键的时候用的是这个模式。模拟输入则用于ADC采集。<br>②输出模式（推挽&#x2F;开漏）<br>&amp;emsp;在输出模式中，推挽模式时双MOS管轮流工作，输出数据寄存器GPIOx_ODR可控制I&#x2F;O输出高低电平。开漏模式时，只有N-MOS管工作，输出数据寄存器可控制I&#x2F;O输出高阻态或低电平。输出速度可配置，有2MHz、10MHz、50MHz几种选项。此处的输出速度即I&#x2F;O支持的高低电平状态最高切换频率，支持的频率越高，功耗越大，如果功耗要求不严格，把速度设置成最大即可。<br>&amp;emsp;在输出模式时肖特基触发器是打开的，即输入可用，通过输入数据寄存器GPIOx_IDR可读取I&#x2F;O的实际状态。<br>③复用功能（推挽&#x2F;开漏）<br>&amp;emsp;复用功能模式中，输出使能，输出速度可配置，可工作在开漏及推挽模式，但是输出信号源于其他外设，输出数据寄存器GPIOx_ODR无效；输入可用，通过输入数据寄存器可获取I&#x2F;O实际状态，但一般直接用外设的寄存器来获取该数据信号。<br>&amp;emsp;通过对GPIO寄存器写入不同的参数，就可以改变GPIO的工作模式。再强调一下，要了解具体寄存器，一定要查阅《STM32F10X-中文参考手册》中对应外设的寄存器说明。在GPIO外设中，控制端口高低控制寄存器CRH和CRL可以配置每个GPIO的工作模式和工作的速度，每4位控制一个IO，CRL控制端口的低8位（见图7-5），CRH控制端口的高8位（见图7-6），具体要看CRL和CRH的寄存器描述。<br><img src="https://img-blog.csdnimg.cn/62cbe1ad306f4b4bb5e0e608a062a0af.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAYW50aG9ueS0zNg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="请添加图片描述"><br><img src="https://img-blog.csdnimg.cn/d10f1281733942bc9696708cce8a87ff.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAYW50aG9ueS0zNg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="请添加图片描述"></p>
<h1 id="三、点亮ELD"><a href="#三、点亮ELD" class="headerlink" title="三、点亮ELD"></a>三、点亮ELD</h1><h2 id="3-1-LED原理"><a href="#3-1-LED原理" class="headerlink" title="3.1 LED原理"></a>3.1 LED原理</h2><p>&amp;emsp;下图是STM32芯片和LED的连接图，这是个RGB灯，有红绿蓝3个小灯组成，使用PWM控制时可以混成256种不同的颜色。<br><img src="https://img-blog.csdnimg.cn/f07c0856e1b2483d9779512a5135ebdd.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAYW50aG9ueS0zNg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>&amp;emsp;图中从3个LED的阳极引出连接到3.3V电源，阴极各经过1个限流电阻引入至STM32的3个GPIO引脚，所以我们只要控制这3个引脚输出高低电平，即可控制其所连接的LED的亮灭。&amp;emsp;如果您的实验板STM32连接到LED的引脚或极性不一样，只需要修改程序到对应的GPIO引脚即可，工作原理都是一样的。</p>
<p>我们的目标是把GPIO的引脚设置成推挽输出模式，并且默认下拉，输出低电平，这样就能让LED亮起来了。</p>
<h2 id="3-2文件准备"><a href="#3-2文件准备" class="headerlink" title="3.2文件准备"></a>3.2文件准备</h2><p>&amp;emsp;在创建工程后，主要有三个文件夹：startup_stm32f10x_hd.s、stm32f10x.h以及main.c。</p>
<h3 id="3-2-1-startup-stm32f10x-hd-s"><a href="#3-2-1-startup-stm32f10x-hd-s" class="headerlink" title="3.2.1 startup_stm32f10x_hd.s"></a>3.2.1 startup_stm32f10x_hd.s</h3><p>&amp;emsp;名为startup_stm32f10x_hd.s的文件中用汇编语言写好了基本程序，当STM32芯片上电启动的时候，首先会执行这里的汇编程序，从而建立起C语言的运行环境，所以我们把这个文件称为启动文件。该文件使用的汇编指令是Cortex-M3内核支持的指令，可参考《Cortex-M3权威指南》中指令集内容。<br>&amp;emsp;startup_stm32f10x_hd.s文件由官方提供，一般需要修改也是在官方的基础上修改，不会自己完全重写。该文件可以从ST固件库里面找到，找到该文件后把启动文件添加到工程中即可。不同型号的芯片以及不同编译环境下使用的汇编文件是不一样的，但功能相同。<br>&amp;emsp;对于启动文件这部分我们主要总结它的功能，不详细讲解里面的代码。其功能如下：</p>
<ul>
<li>初始化堆栈指针SP。</li>
<li>初始化程序计数器指针PC。</li>
<li>设置堆、栈的大小。</li>
<li>初始化中断向量表。</li>
<li>配置外部SRAM作为数据存储器（这个由用户配置，一般的开发板没有外部SRAM）。</li>
<li>调用System Ini() 函数配置STM32的系统时钟。</li>
<li>设置C库的分支入口“__main”（最终用来调用main函数）。</li>
</ul>
<h3 id="3-2-2-stm32f10x-h"><a href="#3-2-2-stm32f10x-h" class="headerlink" title="3.2.2 stm32f10x.h"></a>3.2.2 stm32f10x.h</h3><p>&amp;emsp;这个文件用来存放STM32寄存器映射的代码</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span>  PERIPH_BASE        ((unsigned int)0x40000000) <span class="comment">//外设初始地址</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>  APB1PERIPH_BASE    PERIPH_BASE <span class="comment">//APB1的初始地址</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>  APB2PERIPH_BASE    (PERIPH_BASE+0x10000) <span class="comment">//APB2的初始地址</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>  AHBPERIPH_BASE     (PERIPH_BASE+0x20000) <span class="comment">//AHB的初始地址</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> RCC_BASE            (AHBPERIPH_BASE + 0x1000)  <span class="comment">//RCC时钟的初始地址</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> GPIOB_BASE           (APB2PERIPH_BASE + 0x0c00) <span class="comment">//GPIOB管脚的初始地址</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">//RCC的AHB2时钟的使能寄存器地址，强制转换成指针</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> RCC_APB2ENR       *(unsigned int*)(RCC_BASE + 0x18) </span></span><br><span class="line"><span class="comment">//GPIOB寄存器地址，强制转换成指针</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> GPIOB_CRL      *(unsigned int*)(GPIOB_BASE + 0x00)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> GPIOB_CRH      *(unsigned int*)(GPIOB_BASE + 0x04)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> GPIOB_ODR      *(unsigned int*)(GPIOB_BASE + 0x0C)</span></span><br></pre></td></tr></table></figure>
<h3 id="3-2-2-main-c"><a href="#3-2-2-main-c" class="headerlink" title="3.2.2 main.c"></a>3.2.2 main.c</h3><p>①GPIO模式<br>&amp;emsp;首先我们把连接到LED的GPIO引脚PB0配置成输出模式，即配置GPIO的端口配置成地7寄存器CRL，见下图。CRL中包含0-7号引脚，每个引脚占用四个寄存器位。MODE为用来配置输出的速度，CNF位用来配置各种输入输出模式。<br><img src="https://img-blog.csdnimg.cn/535ae0f1579c47bd9f389fa0ec3b3f8e.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAYW50aG9ueS0zNg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="请添加图片描述"></p>
<p>&amp;emsp;在这里我们把PB0配置为通用推免输出，输出速度为10M。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//清空控制PB0的端口位</span></span><br><span class="line">GPIO_CRL &amp;= ~(<span class="number">0x00</span> &lt;&lt; (<span class="number">4</span>*<span class="number">0</span>));</span><br><span class="line"><span class="comment">//配置PB0为通用推免输出，速度为10M</span></span><br><span class="line">GPIO_CRL |=(<span class="number">1</span>&lt;&lt;<span class="number">4</span>*<span class="number">0</span>);</span><br></pre></td></tr></table></figure>
<p>&amp;emsp;在代码中，我们首先把控制PB0的端口位清零，然后向他赋值“0001”，从而将GPIOB0的引脚设置成输出模式，速度为10M。</p>
<p>&amp;emsp;代码中使用了“&amp;&#x3D;~”和“|&#x3D;”这种操作方法，这是为了避免影响寄存器中的其他位，因为寄存器不能按位读写，不能直接赋值“0x00 0001”，这样就会影响他的高四位引脚。<br>②控制引脚输出电平<br>在输出模式时，对端口位设置&#x2F;清除寄存器BSRR寄存器、端口位清除寄存器BRR和ODR寄存器写入参数即可控制引脚的电平状态，其中操作BSRR和BRR最终影响的都是ODR寄存器，然后通过ODR寄存器的输出来控制GPIO，见下图。为了一步到位，我们在这里直接操作ODR寄存器来控制GPIO的电平，具体见代码。<br><img src="https://img-blog.csdnimg.cn/246699f0c6874ab0804fc10a6bf4d354.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAYW50aG9ueS0zNg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="请添加图片描述"></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//PB0输出低电平</span></span><br><span class="line">GPIOB_ODR &amp;= ~(<span class="number">1</span>&lt;&lt;<span class="number">0</span>);   <span class="comment">//1左移0位，并取反</span></span><br><span class="line"><span class="comment">//或</span></span><br><span class="line">GPIOB_ODR |= (<span class="number">0</span>&lt;&lt;<span class="number">0</span>); </span><br></pre></td></tr></table></figure>
<p>③开启时钟外设<br>设置完GPIO的引脚，控制了电平输出，其实还差最后一步。由于STM32的外设很多，为了降低功耗，每个外设都对应一个时钟。在芯片刚上电的时候这些时钟都是关闭的，如果想要外设工作，必须把相应的时钟打开。<br>STM32的所有外设的时钟由一个专门的外设来管理，叫RCC（reset and clockcontrol）,。<br><img src="https://img-blog.csdnimg.cn/3ebe89f4d63a45dd85cb6a8a9e537b66.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAYW50aG9ueS0zNg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="请添加图片描述"><br>所有的GPIO都挂载到APB2总线上，具体的时钟由APB2外设时钟使能寄存器（RCC_ APB2ENR）来控制。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//开启GPIOB端口时钟</span></span><br><span class="line">RCC_APB2ENR |= (<span class="number">1</span>&lt;&lt;<span class="number">3</span>);</span><br></pre></td></tr></table></figure>
<p>④完成</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;stm32f10x.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span> <span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">//打开GPIOB端口的时钟</span></span><br><span class="line">	RCC_APB2ENR |= ((<span class="number">1</span>)&lt;&lt;<span class="number">3</span>);</span><br><span class="line">	<span class="comment">//清空控制PB0的端口位</span></span><br><span class="line">	GPIO_CRL &amp;= ~(<span class="number">0x00</span> &lt;&lt; (<span class="number">4</span>*<span class="number">0</span>));</span><br><span class="line">	<span class="comment">//配置PB0为通用推免输出，速度为10M</span></span><br><span class="line">	GPIOB_CRL |= ((<span class="number">1</span>)&lt;&lt;(<span class="number">4</span>*<span class="number">0</span>));</span><br><span class="line">	<span class="comment">//PB0输出低电平</span></span><br><span class="line">	GPIOB_ODR &amp;= ~(<span class="number">1</span>&lt;&lt;<span class="number">0</span>);   </span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span>  <span class="title">SystemInit</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="3-3-点亮三个灯"><a href="#3-3-点亮三个灯" class="headerlink" title="3.3 点亮三个灯"></a>3.3 点亮三个灯</h2><p>①startup_stm32f10x_hd.s文件配置</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*本文件用于添加寄存器地址及结构体定义*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*片上外设基地址  */</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PERIPH_BASE           ((unsigned int)0x40000000)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*APB2 总线基地址 */</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> APB2PERIPH_BASE       (PERIPH_BASE + 0x10000)</span></span><br><span class="line"><span class="comment">/* AHB总线基地址 */</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> AHBPERIPH_BASE        (PERIPH_BASE + 0x20000)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*GPIOB外设基地址*/</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> GPIOB_BASE            (APB2PERIPH_BASE + 0x0C00)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* GPIOB寄存器地址,强制转换成指针 */</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> GPIOB_CRL			*(unsigned int*)(GPIOB_BASE+0x00)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> GPIOB_CRH			*(unsigned int*)(GPIOB_BASE+0x04)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> GPIOB_IDR			*(unsigned int*)(GPIOB_BASE+0x08)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> GPIOB_ODR			*(unsigned int*)(GPIOB_BASE+0x0C)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> GPIOB_BSRR	  *(unsigned int*)(GPIOB_BASE+0x10)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> GPIOB_BRR			*(unsigned int*)(GPIOB_BASE+0x14)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> GPIOB_LCKR		*(unsigned int*)(GPIOB_BASE+0x18)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*RCC外设基地址*/</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> RCC_BASE      (AHBPERIPH_BASE + 0x1000)</span></span><br><span class="line"><span class="comment">/*RCC的AHB1时钟使能寄存器地址,强制转换成指针*/</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> RCC_APB2ENR		 *(unsigned int*)(RCC_BASE+0x18)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>②main.c文件</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	*工程模板(寄存器版本)</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;stm32f10x.h&quot;</span> </span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  *   主函数</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;	</span><br><span class="line">	<span class="comment">// 开启GPIOB 端口时钟</span></span><br><span class="line">	RCC_APB2ENR |= (<span class="number">1</span>&lt;&lt;<span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//清空控制PB0的端口位</span></span><br><span class="line">	GPIOB_CRL &amp;= ~( <span class="number">0x0F</span>&lt;&lt; (<span class="number">4</span>*<span class="number">0</span>));	</span><br><span class="line">	<span class="comment">// 配置PB0为通用推挽输出，速度为10M</span></span><br><span class="line">	GPIOB_CRL |= (<span class="number">1</span>&lt;&lt;<span class="number">4</span>*<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// PB0 输出 低电平</span></span><br><span class="line">	GPIOB_ODR &amp;= ~(<span class="number">1</span>&lt;&lt;<span class="number">0</span>);</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//清空控制PB1的端口位</span></span><br><span class="line">	GPIOB_CRL &amp;= ~( <span class="number">0x0F</span>&lt;&lt; (<span class="number">4</span>*<span class="number">1</span>));	</span><br><span class="line">	<span class="comment">// 配置PB1为通用推挽输出，速度为10M</span></span><br><span class="line">	GPIOB_CRL |= (<span class="number">1</span>&lt;&lt;<span class="number">4</span>*<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// PB1 输出 低电平</span></span><br><span class="line">	GPIOB_ODR &amp;= ~(<span class="number">1</span>&lt;&lt;<span class="number">1</span>);</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//清空控制PB5的端口位</span></span><br><span class="line">	GPIOB_CRL &amp;= ~( <span class="number">0x0F</span>&lt;&lt; (<span class="number">4</span>*<span class="number">5</span>));	</span><br><span class="line">	<span class="comment">// 配置PB5为通用推挽输出，速度为10M</span></span><br><span class="line">	GPIOB_CRL |= (<span class="number">1</span>&lt;&lt;<span class="number">4</span>*<span class="number">5</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// PB5 输出 低电平</span></span><br><span class="line">	GPIOB_ODR &amp;= ~(<span class="number">1</span>&lt;&lt;<span class="number">5</span>);</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 函数为空，目的是为了骗过编译器不报错</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">SystemInit</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/STM32/" rel="tag">STM32</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-C++实现通讯录管理系统"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2021/04/10/C++%E5%AE%9E%E7%8E%B0%E9%80%9A%E8%AE%AF%E5%BD%95%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/"
    >在ROS中使用C++中，ros_ros.h报错_找不到</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2021/04/10/C++%E5%AE%9E%E7%8E%B0%E9%80%9A%E8%AE%AF%E5%BD%95%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/" class="article-date">
  <time datetime="2021-04-10T07:12:10.000Z" itemprop="datePublished">2021-04-10</time>
</a>    
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <p>通讯录管理系统C++的实现，用到了不少结构体和函数体的调用，是一个C++入门小项目，同时可以作为自己熟悉C++语法的项目。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAX 1000</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="comment">//设计联系人结构体</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Person</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="comment">//姓名</span></span><br><span class="line">	string m_Name;</span><br><span class="line">	<span class="comment">//性别 男 1 女 2</span></span><br><span class="line">	<span class="type">int</span> m_Sex;</span><br><span class="line">	<span class="comment">//年龄</span></span><br><span class="line">	<span class="type">int</span> m_Age;</span><br><span class="line">	<span class="comment">//电话</span></span><br><span class="line">	string m_Phone;</span><br><span class="line">	<span class="comment">//住址</span></span><br><span class="line">	string m_Addr;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//设置通讯录结构体</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Addressbooks</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="comment">//通讯中保存联系人数组</span></span><br><span class="line">	<span class="keyword">struct</span> <span class="title class_">Person</span> personArray[MAX];</span><br><span class="line"></span><br><span class="line">	<span class="comment">//通讯录中当前记录联系人个数</span></span><br><span class="line">	<span class="type">int</span> m_Size;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//1.添加联系人</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">addPerson</span><span class="params">(Addressbooks * abs)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">//判断通讯录是否已满，如果满了就不在添加</span></span><br><span class="line">	<span class="keyword">if</span> (abs-&gt;m_Size == MAX)</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;通讯录已满，无法添加！&quot;</span> &lt;&lt; endl;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">//添加具体的联系人</span></span><br><span class="line">		<span class="comment">//姓名</span></span><br><span class="line">		string name;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;请输入姓名:&quot;</span> &lt;&lt; endl;</span><br><span class="line">		cin &gt;&gt; name;</span><br><span class="line">		abs-&gt;personArray[abs-&gt;m_Size].m_Name = name;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//性别 </span></span><br><span class="line">		cout &lt;&lt; <span class="string">&quot; 请输入性别&quot;</span> &lt;&lt; endl;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;1 -- 男&quot;</span> &lt;&lt;  endl;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;2 -- 女&quot;</span> &lt;&lt; endl;</span><br><span class="line">		<span class="type">int</span> sex = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">while</span> (<span class="literal">true</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="comment">//</span></span><br><span class="line">			cin &gt;&gt; sex;</span><br><span class="line">			<span class="keyword">if</span> (sex == <span class="number">1</span> || sex == <span class="number">2</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				abs-&gt;personArray[abs-&gt;m_Size].m_Sex = sex;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> </span><br><span class="line">				cout &lt;&lt; <span class="string">&quot;输入有误，请重新输入！&quot;</span> &lt;&lt; endl;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//年龄</span></span><br><span class="line">		cout &lt;&lt;  <span class="string">&quot;请输入年龄：&quot;</span>  &lt;&lt;  endl;</span><br><span class="line">		<span class="type">int</span> age = <span class="number">0</span>;</span><br><span class="line">		cin &gt;&gt; age;</span><br><span class="line">		abs-&gt;personArray[abs-&gt;m_Size].m_Age = age;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//电话</span></span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;请输入联系电话：&quot;</span> &lt;&lt; endl;</span><br><span class="line">		string phone;</span><br><span class="line">		cin &gt;&gt; phone;</span><br><span class="line">		abs-&gt;personArray[abs-&gt;m_Size].m_Phone = phone;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//住址</span></span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;请输入家庭住址：&quot;</span> &lt;&lt; endl;</span><br><span class="line">		string address;</span><br><span class="line">		cin &gt;&gt; address;</span><br><span class="line">		abs-&gt;personArray[abs-&gt;m_Size].m_Addr =  address;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//更新通讯录中的人数</span></span><br><span class="line">		abs-&gt;m_Size++;</span><br><span class="line"></span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;添加成功&quot;</span> &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">system</span>(<span class="string">&quot;pause&quot;</span>);<span class="comment">//请按任意键继续</span></span><br><span class="line">		<span class="built_in">system</span>(<span class="string">&quot;cls&quot;</span>);<span class="comment">//清屏操作</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//2.显示所有联系人</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">showPerson</span><span class="params">(Addressbooks * abs)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">//判断通讯录中人数是否为0，如果为0，提示记录为零</span></span><br><span class="line">	<span class="comment">//如果不为0.显示记录的联系人信息</span></span><br><span class="line">	<span class="keyword">if</span> (abs-&gt;m_Size == <span class="number">0</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;当前记录为空&quot;</span> &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; abs-&gt;m_Size; i++)</span><br><span class="line">		&#123;</span><br><span class="line">			cout &lt;&lt; <span class="string">&quot;姓名；&quot;</span> &lt;&lt; abs-&gt;personArray[i].m_Name &lt;&lt; endl;</span><br><span class="line">			cout &lt;&lt; <span class="string">&quot;性别；&quot;</span> &lt;&lt; (abs-&gt;personArray[i].m_Sex == <span class="number">1</span> ?<span class="string">&quot;男&quot;</span>:<span class="string">&quot;女&quot;</span> )&lt;&lt; endl;</span><br><span class="line">			cout &lt;&lt; <span class="string">&quot;年龄；&quot;</span> &lt;&lt; abs-&gt;personArray[i].m_Age &lt;&lt; endl;</span><br><span class="line">			cout &lt;&lt; <span class="string">&quot;电话；&quot;</span> &lt;&lt; abs-&gt;personArray[i].m_Phone &lt;&lt; endl;</span><br><span class="line">			cout &lt;&lt; <span class="string">&quot;住址；&quot;</span> &lt;&lt; abs-&gt;personArray[i].m_Addr &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">system</span>(<span class="string">&quot;pause&quot;</span>);<span class="comment">//按任意键继续</span></span><br><span class="line">	<span class="built_in">system</span>(<span class="string">&quot;cls&quot;</span>);<span class="comment">//清屏</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//检测联系人是否存在，如果存在，返回联系人所在数组中的具体位置，不存在返回-1</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">isExist</span><span class="params">(Addressbooks* abs, string name)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; abs-&gt;m_Size; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">//找到用户输入的姓名了</span></span><br><span class="line">		<span class="keyword">if</span> (abs-&gt;personArray[i].m_Name == name)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">return</span> i;<span class="comment">//找到了返回这个人在数组中的下标编号</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">-1</span>;<span class="comment">//如果遍历结束都没有找到，返回-1</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//3.删除指定联系人</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">deletePerson</span><span class="params">(Addressbooks* abs)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;请输入您要删除的联系人：&quot;</span> &lt;&lt; endl;</span><br><span class="line">	string name;</span><br><span class="line">	cin &gt;&gt; name;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//ret == -1  未查到</span></span><br><span class="line">	<span class="comment">//ret ！= -1  查到了</span></span><br><span class="line">	<span class="type">int</span> ret = <span class="built_in">isExist</span>(abs, name);</span><br><span class="line">	<span class="keyword">if</span> (ret != <span class="number">-1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">//查找到此人，要进行删除操作</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> i = ret; i &lt; abs-&gt;m_Size; i++)</span><br><span class="line">		&#123;</span><br><span class="line">			abs-&gt;personArray[i] = abs-&gt;personArray[i + <span class="number">1</span>];</span><br><span class="line">		&#125;</span><br><span class="line">		abs-&gt;m_Size--;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;删除成功！&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;查无此人&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">system</span>(<span class="string">&quot;pause&quot;</span>);<span class="comment">//按任意键继续</span></span><br><span class="line">	<span class="built_in">system</span>(<span class="string">&quot;cls&quot;</span>);<span class="comment">//清屏</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//4.查找指定的联系人信息</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">findPerson</span><span class="params">(Addressbooks* abs)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;请输入您要查找的联系人&quot;</span> &lt;&lt; endl;</span><br><span class="line">	string name;</span><br><span class="line">	cin &gt;&gt; name;</span><br><span class="line">	<span class="comment">//判断指定的联系人是否存在通讯录中</span></span><br><span class="line">	<span class="type">int</span> ret = <span class="built_in">isExist</span>(abs, name);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (ret != <span class="number">-1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;姓名；&quot;</span> &lt;&lt; abs-&gt;personArray[ret].m_Name &lt;&lt; endl;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;性别；&quot;</span> &lt;&lt; (abs-&gt;personArray[ret].m_Sex == <span class="number">1</span> ? <span class="string">&quot;男&quot;</span> : <span class="string">&quot;女&quot;</span>) &lt;&lt; endl;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;年龄；&quot;</span> &lt;&lt; abs-&gt;personArray[ret].m_Age &lt;&lt; endl;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;电话；&quot;</span> &lt;&lt; abs-&gt;personArray[ret].m_Phone &lt;&lt; endl;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;住址；&quot;</span> &lt;&lt; abs-&gt;personArray[ret].m_Addr &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;查无此人&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">system</span>(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">	<span class="built_in">system</span>(<span class="string">&quot;cls&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//5.修改指定联系人信息</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">modifyPerson</span><span class="params">(Addressbooks* abs)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;请输入您要修改的联系人信息&quot;</span> &lt;&lt; endl;</span><br><span class="line">	string name;</span><br><span class="line">	cin &gt;&gt; name;</span><br><span class="line">	</span><br><span class="line">	<span class="type">int</span> ret = <span class="built_in">isExist</span>(abs, name);</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> (ret != <span class="number">-1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">//姓名</span></span><br><span class="line">		string name;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;请输入姓名:&quot;</span> &lt;&lt; endl;</span><br><span class="line">		cin &gt;&gt; name;</span><br><span class="line">		abs-&gt;personArray[abs-&gt;m_Size].m_Name = name;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//性别 </span></span><br><span class="line">		cout &lt;&lt; <span class="string">&quot; 请输入性别&quot;</span> &lt;&lt; endl;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;1 -- 男&quot;</span> &lt;&lt; endl;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;2 -- 女&quot;</span> &lt;&lt; endl;</span><br><span class="line">		<span class="type">int</span> sex = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">while</span> (<span class="literal">true</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="comment">//</span></span><br><span class="line">			cin &gt;&gt; sex;</span><br><span class="line">			<span class="keyword">if</span> (sex == <span class="number">1</span> || sex == <span class="number">2</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				abs-&gt;personArray[abs-&gt;m_Size].m_Sex = sex;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> </span><br><span class="line">				cout &lt;&lt; <span class="string">&quot;输入有误，请重新输入！&quot;</span> &lt;&lt; endl;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//年龄</span></span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;请输入年龄：&quot;</span> &lt;&lt; endl;</span><br><span class="line">		<span class="type">int</span> age = <span class="number">0</span>;</span><br><span class="line">		cin &gt;&gt; age;</span><br><span class="line">		abs-&gt;personArray[abs-&gt;m_Size].m_Age = age;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//电话</span></span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;请输入联系电话：&quot;</span> &lt;&lt; endl;</span><br><span class="line">		string phone;</span><br><span class="line">		cin &gt;&gt; phone;</span><br><span class="line">		abs-&gt;personArray[abs-&gt;m_Size].m_Phone = phone;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//住址</span></span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;请输入家庭住址：&quot;</span> &lt;&lt; endl;</span><br><span class="line">		string address;</span><br><span class="line">		cin &gt;&gt; address;</span><br><span class="line">		abs-&gt;personArray[abs-&gt;m_Size].m_Addr = address;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;修改成功&quot;</span> &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;查无此人&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">system</span>(<span class="string">&quot;pause&quot;</span>);<span class="comment">//请按任意键继续</span></span><br><span class="line">	<span class="built_in">system</span>(<span class="string">&quot;cls&quot;</span>);<span class="comment">//清屏操作</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//6.清空所有联系人</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">clearnPerson</span><span class="params">(Addressbooks* abs)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	abs-&gt;m_Size = <span class="number">0</span>; <span class="comment">//将当前记录的联系人数目置为0，做逻辑清空操作</span></span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;通讯录已清空&quot;</span> &lt;&lt; endl;</span><br><span class="line">	<span class="comment">//按任意键后清屏</span></span><br><span class="line">	<span class="built_in">system</span>(<span class="string">&quot;pause&quot;</span>);<span class="comment">//请按任意键继续</span></span><br><span class="line">	<span class="built_in">system</span>(<span class="string">&quot;cls&quot;</span>);<span class="comment">//清屏操作</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//菜单界面</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">showMenu</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;***********************&quot;</span> &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;*****1、添加联系人*****&quot;</span> &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;*****2、显示联系人*****&quot;</span> &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;*****3、删除联系人*****&quot;</span> &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;*****4、查找联系人*****&quot;</span> &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;*****5、修改联系人*****&quot;</span> &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;*****6、清空联系人*****&quot;</span> &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;*****0、退出通讯录*****&quot;</span> &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;***********************&quot;</span> &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	Addressbooks abs;</span><br><span class="line"></span><br><span class="line">	abs.m_Size = <span class="number">0</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="type">int</span> select = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span> (<span class="literal">true</span>)</span><br><span class="line">	&#123;	</span><br><span class="line">		<span class="built_in">showMenu</span>();</span><br><span class="line"></span><br><span class="line">		cin &gt;&gt; select;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">switch</span> (select)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">1</span> : <span class="comment">//添加联系人</span></span><br><span class="line">				<span class="built_in">addPerson</span>( &amp; abs );</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">2</span> : <span class="comment">//显示联系人</span></span><br><span class="line">				<span class="built_in">showPerson</span>(&amp;abs);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">3</span> : <span class="comment">//删除联系人</span></span><br><span class="line">			&#123;</span><br><span class="line">				cout &lt;&lt; <span class="string">&quot;请输入删除联系人姓名：&quot;</span> &lt;&lt;  endl;</span><br><span class="line">				string name;</span><br><span class="line">				cin &gt;&gt; name;</span><br><span class="line">				<span class="keyword">if</span> (<span class="built_in">isExist</span>(&amp;abs, name) == <span class="number">-1</span>)</span><br><span class="line">				&#123;</span><br><span class="line">					cout &lt;&lt; <span class="string">&quot;查无此人&quot;</span> &lt;&lt; endl;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">else</span></span><br><span class="line">				&#123;</span><br><span class="line">					cout &lt;&lt; <span class="string">&quot;找到此人&quot;</span> &lt;&lt; endl;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">4</span> :<span class="comment">//查找联系人</span></span><br><span class="line">				<span class="built_in">findPerson</span>(&amp;abs);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">5</span> : <span class="comment">//修改联系人</span></span><br><span class="line">				<span class="built_in">modifyPerson</span>(&amp;abs);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">6</span> : <span class="comment">//清空联系人</span></span><br><span class="line">				<span class="built_in">clearnPerson</span>(&amp;abs);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">0</span> : <span class="comment">//退出通讯录</span></span><br><span class="line"></span><br><span class="line">				cout &lt;&lt; <span class="string">&quot;欢迎下次使用&quot;</span> &lt;&lt; endl;</span><br><span class="line">				<span class="built_in">system</span>(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">				<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">default</span>:</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">system</span>(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/C/" rel="tag">C++</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
  </article>
  

  
</section>
</div>

      <footer class="footer">
  <div class="outer">
    <ul>
      <li>
        Copyrights &copy;
        2015-2022
        <i class="ri-heart-fill heart_icon"></i> yzxie
      </li>
    </ul>
    <ul>
      <li>
        
      </li>
    </ul>
    <ul>
      <li>
        
        
        <span>
  <span><i class="ri-user-3-fill"></i>Visitors:<span id="busuanzi_value_site_uv"></span></span>
  <span class="division">|</span>
  <span><i class="ri-eye-fill"></i>Views:<span id="busuanzi_value_page_pv"></span></span>
</span>
        
      </li>
    </ul>
    <ul>
      
    </ul>
    <ul>
      
    </ul>
    <ul>
      <li>
        <!-- cnzz统计 -->
        
        <script type="text/javascript" src='https://s9.cnzz.com/z_stat.php?id=1278069914&amp;web_id=1278069914'></script>
        
      </li>
    </ul>
  </div>
</footer>    
    </main>
    <div class="float_btns">
      <div class="totop" id="totop">
  <i class="ri-arrow-up-line"></i>
</div>

<div class="todark" id="todark">
  <i class="ri-moon-line"></i>
</div>

    </div>
    <aside class="sidebar on">
      <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="/images/touxiang.png" alt="Anthony"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">主页</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/archives">归档</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/categories">分类</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags">标签</a>
    </li>
    
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
      <a class="nav-item-link nav-item-search"  title="Search">
        <i class="ri-search-line"></i>
      </a>
      
      
      <a class="nav-item-link" target="_blank" href="/atom.xml" title="RSS Feed">
        <i class="ri-rss-line"></i>
      </a>
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
    </aside>
    <div id="mask"></div>

<!-- #reward -->
<div id="reward">
  <span class="close"><i class="ri-close-line"></i></span>
  <p class="reward-p"><i class="ri-cup-line"></i>请我喝杯咖啡吧~</p>
  <div class="reward-box">
    
    <div class="reward-item">
      <img class="reward-img" src="/images/alipay.jpg">
      <span class="reward-type">支付宝</span>
    </div>
    
    
    <div class="reward-item">
      <img class="reward-img" src="/images/wechat.jpg">
      <span class="reward-type">微信</span>
    </div>
    
  </div>
</div>
    
<script src="/js/jquery-3.6.0.min.js"></script>
 
<script src="/js/lazyload.min.js"></script>

<!-- Tocbot -->

<script src="https://cdn.staticfile.org/jquery-modal/0.9.2/jquery.modal.min.js"></script>
<link
  rel="stylesheet"
  href="https://cdn.staticfile.org/jquery-modal/0.9.2/jquery.modal.min.css"
/>
<script src="https://cdn.staticfile.org/justifiedGallery/3.8.1/js/jquery.justifiedGallery.min.js"></script>

<script src="/dist/main.js"></script>

<!-- ImageViewer -->
 <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<link rel="stylesheet" href="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe.min.css">
<link rel="stylesheet" href="https://cdn.staticfile.org/photoswipe/4.1.3/default-skin/default-skin.min.css">
<script src="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe.min.js"></script>
<script src="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe-ui-default.min.js"></script>

<script>
    function viewer_init() {
        let pswpElement = document.querySelectorAll('.pswp')[0];
        let $imgArr = document.querySelectorAll(('.article-entry img:not(.reward-img)'))

        $imgArr.forEach(($em, i) => {
            $em.onclick = () => {
                // slider展开状态
                // todo: 这样不好，后面改成状态
                if (document.querySelector('.left-col.show')) return
                let items = []
                $imgArr.forEach(($em2, i2) => {
                    let img = $em2.getAttribute('data-idx', i2)
                    let src = $em2.getAttribute('data-target') || $em2.getAttribute('src')
                    let title = $em2.getAttribute('alt')
                    // 获得原图尺寸
                    const image = new Image()
                    image.src = src
                    items.push({
                        src: src,
                        w: image.width || $em2.width,
                        h: image.height || $em2.height,
                        title: title
                    })
                })
                var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, {
                    index: parseInt(i)
                });
                gallery.init()
            }
        })
    }
    viewer_init()
</script> 
<!-- MathJax -->

<!-- Katex -->

<!-- busuanzi  -->
 
<script src="/js/busuanzi-2.3.pure.min.js"></script>
 
<!-- ClickLove -->

<!-- ClickBoom1 -->

<!-- ClickBoom2 -->

<!-- CodeCopy -->
 
<link rel="stylesheet" href="/css/clipboard.css">
 <script src="https://cdn.staticfile.org/clipboard.js/2.0.10/clipboard.min.js"></script>
<script>
  function wait(callback, seconds) {
    var timelag = null;
    timelag = window.setTimeout(callback, seconds);
  }
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="ri-file-copy-2-line"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      $(".article pre code").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copied');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-checkbox-circle-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPIED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-checkbox-circle-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-time-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-time-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
    }
    initCopyCode();
  }(window, document);
</script>
 
<!-- CanvasBackground -->
 
<script src="/js/dz.js"></script>
 
<script>
  if (window.mermaid) {
    mermaid.initialize({ theme: "forest" });
  }
</script>


    
    

  </div>
</body>

</html>